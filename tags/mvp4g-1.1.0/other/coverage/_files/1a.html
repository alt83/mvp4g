<HTML><HEAD><META CONTENT="text/html; charset=UTF-8" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://www.eclemma.org/">EMMA</A> Coverage Report (generated Tue Mar 16 18:57:23 EDT 2010)</TH></TR><TR><TD CLASS="nv">[<A HREF="../10_03_16_coverage.html">all classes</A>][<A HREF="5.html">com.mvp4g.util.config</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">Mvp4gConfiguration.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>Mvp4gConfiguration.java</TD><TD>100% (1/1)</TD><TD>98%  (61/62)</TD><TD>93%  (2169/2342)</TD><TD>90%  (436/487)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">Mvp4gConfiguration</A></TD><TD>100% (1/1)</TD><TD>98%  (61/62)</TD><TD>93%  (2169/2342)</TD><TD>90%  (436/487)</TD></TR><TR><TD CLASS="f"><A HREF="#1">load (JClassType, Map): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/144)</TD><TD CLASS="h">0%   (0/44)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">validateHistoryConverters (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>91%  (267/292)</TD><TD>93%  (52/56)</TD></TR><TR><TD CLASS="f"><A HREF="#3">findParentModule (String): JClassType</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>98%  (49/50)</TD><TD>100% (10/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">findChildModuleHistoryName (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>98%  (63/64)</TD><TD>92%  (12/13)</TD></TR><TR><TD CLASS="f"><A HREF="#5">findEventObjectClass (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>99%  (144/146)</TD><TD>94%  (30/32)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#0">Mvp4gConfiguration (TreeLogger, TypeOracle): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (77/77)</TD><TD>100% (22/22)</TD></TR><TR><TD CLASS="f"><A HREF="#7">checkUniquenessOf (Set, Set): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (25/25)</TD><TD>100% (5/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">checkUniquenessOfAllElements (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (35/35)</TD><TD>100% (8/8)</TD></TR><TR><TD CLASS="f"><A HREF="#9">getChildModules (): Set</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a">getDebug (): DebugElement</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b">getElement (String, Set, Mvp4gElement): Mvp4gElement</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (31/31)</TD><TD>100% (8/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">getEventBus (): EventBusElement</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#d">getEvents (): Set</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">getHistory (): HistoryElement</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#f">getHistoryConverters (): Set</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">getHistoryName (): String</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">getLoadChildConfig (): ChildModulesElement</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#12">getModule (): JClassType</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#13">getOracle (): TypeOracle</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#14">getOthersEventBusClassMap (): Map</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#15">getParentEventBus (): JClassType</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#16">getParentModule (): JClassType</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#17">getPresenters (): Set</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#18">getServices (): Set</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#19">getStart (): StartElement</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1a">getType (Mvp4gElement, String): JClassType</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (15/15)</TD><TD>100% (4/4)</TD></TR><TR><TD CLASS="f"><A HREF="#1b">getViews (): Set</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1c">hasParentModule (String): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (8/8)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1d">isAsyncEnabled (): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1e">isParentEventBusXml (): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (14/14)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1f">loadChildConfig (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#20">loadChildModules (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#21">loadDebug (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#22">loadEvents (List): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#23">loadEvents (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (24/24)</TD><TD>100% (5/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#24">loadHistory (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#25">loadHistoryConverters (List): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#26">loadHistoryConverters (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#27">loadParentModule (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (47/47)</TD><TD>100% (10/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#28">loadPresenters (List): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#29">loadPresenters (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2a">loadServices (List): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#2b">loadServices (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2c">loadStart (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#2d">loadViews (XMLConfiguration): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (10/10)</TD><TD>100% (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2e">removeUselessElements (Set, Set): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (34/34)</TD><TD>100% (4/4)</TD></TR><TR><TD CLASS="f"><A HREF="#2f">setDebug (DebugElement): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#30">setEventBus (EventBusElement): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#31">setHistory (HistoryElement): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#32">setHistoryName (String): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#33">setLoadChildConfig (ChildModulesElement): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#34">setModule (JClassType): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#35">setParentEventBus (JClassType): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#36">setParentModule (JClassType): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#37">setStart (StartElement): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#38">validateChildModules (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (282/282)</TD><TD>100% (47/47)</TD></TR><TR><TD CLASS="f"><A HREF="#39">validateEventHandlers (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (224/224)</TD><TD>100% (41/41)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3a">validateEvents (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (229/229)</TD><TD>100% (35/35)</TD></TR><TR><TD CLASS="f"><A HREF="#3b">validateHistory (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (57/57)</TD><TD>100% (11/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3c">validateServices (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (150/150)</TD><TD>100% (25/25)</TD></TR><TR><TD CLASS="f"><A HREF="#3d">validateStart (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (67/67)</TD><TD>100% (9/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3e">validateViews (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (105/105)</TD><TD>100% (21/21)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>/**</TD></TR><TR><TD CLASS="l">2</TD><TD> * </TD></TR><TR><TD CLASS="l">3</TD><TD> */</TD></TR><TR><TD CLASS="l">4</TD><TD>package com.mvp4g.util.config;</TD></TR><TR><TD CLASS="l">5</TD><TD> </TD></TR><TR><TD CLASS="l">6</TD><TD>import java.io.InputStream;</TD></TR><TR><TD CLASS="l">7</TD><TD>import java.lang.annotation.Annotation;</TD></TR><TR><TD CLASS="l">8</TD><TD>import java.util.ArrayList;</TD></TR><TR><TD CLASS="l">9</TD><TD>import java.util.HashMap;</TD></TR><TR><TD CLASS="l">10</TD><TD>import java.util.HashSet;</TD></TR><TR><TD CLASS="l">11</TD><TD>import java.util.List;</TD></TR><TR><TD CLASS="l">12</TD><TD>import java.util.Map;</TD></TR><TR><TD CLASS="l">13</TD><TD>import java.util.Set;</TD></TR><TR><TD CLASS="l">14</TD><TD> </TD></TR><TR><TD CLASS="l">15</TD><TD>import org.apache.commons.configuration.ConfigurationException;</TD></TR><TR><TD CLASS="l">16</TD><TD>import org.apache.commons.configuration.XMLConfiguration;</TD></TR><TR><TD CLASS="l">17</TD><TD> </TD></TR><TR><TD CLASS="l">18</TD><TD>import com.google.gwt.core.ext.TreeLogger;</TD></TR><TR><TD CLASS="l">19</TD><TD>import com.google.gwt.core.ext.typeinfo.JClassType;</TD></TR><TR><TD CLASS="l">20</TD><TD>import com.google.gwt.core.ext.typeinfo.JGenericType;</TD></TR><TR><TD CLASS="l">21</TD><TD>import com.google.gwt.core.ext.typeinfo.JMethod;</TD></TR><TR><TD CLASS="l">22</TD><TD>import com.google.gwt.core.ext.typeinfo.JParameter;</TD></TR><TR><TD CLASS="l">23</TD><TD>import com.google.gwt.core.ext.typeinfo.JParameterizedType;</TD></TR><TR><TD CLASS="l">24</TD><TD>import com.google.gwt.core.ext.typeinfo.JType;</TD></TR><TR><TD CLASS="l">25</TD><TD>import com.google.gwt.core.ext.typeinfo.TypeOracle;</TD></TR><TR><TD CLASS="l">26</TD><TD>import com.mvp4g.client.Mvp4gModule;</TD></TR><TR><TD CLASS="l">27</TD><TD>import com.mvp4g.client.annotation.Events;</TD></TR><TR><TD CLASS="l">28</TD><TD>import com.mvp4g.client.annotation.History;</TD></TR><TR><TD CLASS="l">29</TD><TD>import com.mvp4g.client.annotation.Presenter;</TD></TR><TR><TD CLASS="l">30</TD><TD>import com.mvp4g.client.annotation.Service;</TD></TR><TR><TD CLASS="l">31</TD><TD>import com.mvp4g.client.annotation.XmlFilePath;</TD></TR><TR><TD CLASS="l">32</TD><TD>import com.mvp4g.client.annotation.module.HistoryName;</TD></TR><TR><TD CLASS="l">33</TD><TD>import com.mvp4g.client.event.BaseEventBusWithLookUp;</TD></TR><TR><TD CLASS="l">34</TD><TD>import com.mvp4g.client.event.EventBusWithLookup;</TD></TR><TR><TD CLASS="l">35</TD><TD>import com.mvp4g.client.history.ClearHistory;</TD></TR><TR><TD CLASS="l">36</TD><TD>import com.mvp4g.client.history.HistoryConverter;</TD></TR><TR><TD CLASS="l">37</TD><TD>import com.mvp4g.client.presenter.PresenterInterface;</TD></TR><TR><TD CLASS="l">38</TD><TD>import com.mvp4g.util.config.element.ChildModuleElement;</TD></TR><TR><TD CLASS="l">39</TD><TD>import com.mvp4g.util.config.element.ChildModulesElement;</TD></TR><TR><TD CLASS="l">40</TD><TD>import com.mvp4g.util.config.element.DebugElement;</TD></TR><TR><TD CLASS="l">41</TD><TD>import com.mvp4g.util.config.element.EventBusElement;</TD></TR><TR><TD CLASS="l">42</TD><TD>import com.mvp4g.util.config.element.EventElement;</TD></TR><TR><TD CLASS="l">43</TD><TD>import com.mvp4g.util.config.element.HistoryConverterElement;</TD></TR><TR><TD CLASS="l">44</TD><TD>import com.mvp4g.util.config.element.HistoryElement;</TD></TR><TR><TD CLASS="l">45</TD><TD>import com.mvp4g.util.config.element.InjectedElement;</TD></TR><TR><TD CLASS="l">46</TD><TD>import com.mvp4g.util.config.element.Mvp4gElement;</TD></TR><TR><TD CLASS="l">47</TD><TD>import com.mvp4g.util.config.element.Mvp4gWithServicesElement;</TD></TR><TR><TD CLASS="l">48</TD><TD>import com.mvp4g.util.config.element.PresenterElement;</TD></TR><TR><TD CLASS="l">49</TD><TD>import com.mvp4g.util.config.element.ServiceElement;</TD></TR><TR><TD CLASS="l">50</TD><TD>import com.mvp4g.util.config.element.StartElement;</TD></TR><TR><TD CLASS="l">51</TD><TD>import com.mvp4g.util.config.element.ViewElement;</TD></TR><TR><TD CLASS="l">52</TD><TD>import com.mvp4g.util.config.loader.annotation.EventsAnnotationsLoader;</TD></TR><TR><TD CLASS="l">53</TD><TD>import com.mvp4g.util.config.loader.annotation.HistoryAnnotationsLoader;</TD></TR><TR><TD CLASS="l">54</TD><TD>import com.mvp4g.util.config.loader.annotation.PresenterAnnotationsLoader;</TD></TR><TR><TD CLASS="l">55</TD><TD>import com.mvp4g.util.config.loader.annotation.ServiceAnnotationsLoader;</TD></TR><TR><TD CLASS="l">56</TD><TD>import com.mvp4g.util.config.loader.xml.ChildModuleLoader;</TD></TR><TR><TD CLASS="l">57</TD><TD>import com.mvp4g.util.config.loader.xml.ChildModulesLoader;</TD></TR><TR><TD CLASS="l">58</TD><TD>import com.mvp4g.util.config.loader.xml.DebugLoader;</TD></TR><TR><TD CLASS="l">59</TD><TD>import com.mvp4g.util.config.loader.xml.EventsLoader;</TD></TR><TR><TD CLASS="l">60</TD><TD>import com.mvp4g.util.config.loader.xml.HistoryConverterLoader;</TD></TR><TR><TD CLASS="l">61</TD><TD>import com.mvp4g.util.config.loader.xml.HistoryLoader;</TD></TR><TR><TD CLASS="l">62</TD><TD>import com.mvp4g.util.config.loader.xml.PresentersLoader;</TD></TR><TR><TD CLASS="l">63</TD><TD>import com.mvp4g.util.config.loader.xml.ServicesLoader;</TD></TR><TR><TD CLASS="l">64</TD><TD>import com.mvp4g.util.config.loader.xml.StartLoader;</TD></TR><TR><TD CLASS="l">65</TD><TD>import com.mvp4g.util.config.loader.xml.ViewsLoader;</TD></TR><TR><TD CLASS="l">66</TD><TD>import com.mvp4g.util.exception.InvalidClassException;</TD></TR><TR><TD CLASS="l">67</TD><TD>import com.mvp4g.util.exception.InvalidMvp4gConfigurationException;</TD></TR><TR><TD CLASS="l">68</TD><TD>import com.mvp4g.util.exception.InvalidTypeException;</TD></TR><TR><TD CLASS="l">69</TD><TD>import com.mvp4g.util.exception.NonUniqueIdentifierException;</TD></TR><TR><TD CLASS="l">70</TD><TD>import com.mvp4g.util.exception.NotFoundClassException;</TD></TR><TR><TD CLASS="l">71</TD><TD>import com.mvp4g.util.exception.UnknownConfigurationElementException;</TD></TR><TR><TD CLASS="l">72</TD><TD>import com.mvp4g.util.exception.element.DuplicatePropertyNameException;</TD></TR><TR><TD CLASS="l">73</TD><TD>import com.mvp4g.util.exception.loader.Mvp4gAnnotationException;</TD></TR><TR><TD CLASS="l">74</TD><TD>import com.mvp4g.util.exception.loader.Mvp4gXmlException;</TD></TR><TR><TD CLASS="l">75</TD><TD> </TD></TR><TR><TD CLASS="l">76</TD><TD>/**</TD></TR><TR><TD CLASS="l">77</TD><TD> * An in-memory representation of all elements in the configuration file and in the annotations.</TD></TR><TR><TD CLASS="l">78</TD><TD> * </TD></TR><TR><TD CLASS="l">79</TD><TD> * @author javier</TD></TR><TR><TD CLASS="l">80</TD><TD> * </TD></TR><TR><TD CLASS="l">81</TD><TD> */</TD></TR><TR><TD CLASS="l">82</TD><TD>public class Mvp4gConfiguration {</TD></TR><TR><TD CLASS="l">83</TD><TD> </TD></TR><TR><TD CLASS="l">84</TD><TD>        private static final String HC_WARNING = &#34;History Converter %s: must be able to translate null objects since it is associated to event %s which is sent with no object.&#34;;</TD></TR><TR><TD CLASS="l">85</TD><TD>        private static final String REMOVE_OBJ = &#34;%s %s: No instance of this class has been created since this class is not used.&#34;;</TD></TR><TR><TD CLASS="l">86</TD><TD>        private static final String MISSING_ATTRIBUTE = &#34;%s: child module %s doesn't define any event to load its view.&#34;;</TD></TR><TR><TD CLASS="l">87</TD><TD>        private static final String NOT_EMPTY_EVENT_OBJ = &#34;%s: %s event %s can't have any object associated with it.&#34;;</TD></TR><TR><TD CLASS="l">88</TD><TD>        private static final String WRONG_EVENT_OBJ = &#34;%s: %s event %s can only be associated with %s&#34;;</TD></TR><TR><TD CLASS="l">89</TD><TD>        private static final String EMPTY_EVENT_OBJ = &#34;Event %s: event must have an object associated with it as it loads a child view.&#34;;</TD></TR><TR><TD CLASS="l">90</TD><TD>        private static final String WRONG_CHILD_LOAD_EVENT_OBJ = &#34;Child Module %s: event %s can not load child module's start view. Can not convert %s to %s.&#34;;</TD></TR><TR><TD CLASS="l">91</TD><TD>        private static final String START_VIEW_XML_WARNING = &#34;Child Module %s: could not verify if child module's start view can be loaded by event %s since child module uses a XML event bus.&#34;;</TD></TR><TR><TD CLASS="l">92</TD><TD>        private static final String PARENT_EVENT_BUS_WARNING = &#34;Parent's event bus is a XML event bus. Mvp4g framework can't verify if parent's event bus can handle events forwarded to it.&#34;;</TD></TR><TR><TD CLASS="l">93</TD><TD>        private static final String NO_PARENT_ERROR = &#34;Event %s: No parent module has been found for this module but this event must be forwarded to it. Have you forgotten to add setParentModule method to your module?&#34;;</TD></TR><TR><TD CLASS="l">94</TD><TD>        private static final String CHILD_MODULE_SAME_HISTORY_NAME = &#34;Module %s: You can't have two child modules with the same history name \&#34;%s\&#34;.&#34;;</TD></TR><TR><TD CLASS="l">95</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">96</TD><TD>        private Set&lt;PresenterElement&gt; presenters = new HashSet&lt;PresenterElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">97</TD><TD>        private Set&lt;ViewElement&gt; views = new HashSet&lt;ViewElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">98</TD><TD>        private Set&lt;EventElement&gt; events = new HashSet&lt;EventElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">99</TD><TD>        private Set&lt;ServiceElement&gt; services = new HashSet&lt;ServiceElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">100</TD><TD>        private Set&lt;HistoryConverterElement&gt; historyConverters = new HashSet&lt;HistoryConverterElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">101</TD><TD>        private Set&lt;ChildModuleElement&gt; childModules = new HashSet&lt;ChildModuleElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">102</TD><TD>        private StartElement start = null;</TD></TR><TR CLASS="c"><TD CLASS="l">103</TD><TD>        private HistoryElement history = null;</TD></TR><TR CLASS="c"><TD CLASS="l">104</TD><TD>        private EventBusElement eventBus = null;</TD></TR><TR CLASS="c"><TD CLASS="l">105</TD><TD>        private JClassType module = null;</TD></TR><TR CLASS="c"><TD CLASS="l">106</TD><TD>        private ChildModulesElement loadChildConfig = null;</TD></TR><TR CLASS="c"><TD CLASS="l">107</TD><TD>        private Map&lt;String, JClassType&gt; othersEventBusClassMap = new HashMap&lt;String, JClassType&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">108</TD><TD>        private JClassType parentModule = null;</TD></TR><TR CLASS="c"><TD CLASS="l">109</TD><TD>        private JClassType parentEventBus = null;</TD></TR><TR CLASS="c"><TD CLASS="l">110</TD><TD>        private String historyName = null;</TD></TR><TR CLASS="c"><TD CLASS="l">111</TD><TD>        private DebugElement debug = null;</TD></TR><TR><TD CLASS="l">112</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">113</TD><TD>        private TreeLogger logger = null;</TD></TR><TR CLASS="c"><TD CLASS="l">114</TD><TD>        private TypeOracle oracle = null;</TD></TR><TR><TD CLASS="l">115</TD><TD> </TD></TR><TR><TD CLASS="l">116</TD><TD>        /**</TD></TR><TR><TD CLASS="l">117</TD><TD>         * Contruct a Mvp4gConfiguration object</TD></TR><TR><TD CLASS="l">118</TD><TD>         * </TD></TR><TR><TD CLASS="l">119</TD><TD>         * @param logger</TD></TR><TR><TD CLASS="l"><A NAME="0">120</A></TD><TD>         *            logger of the GWT compiler</TD></TR><TR><TD CLASS="l">121</TD><TD>         * @param oracle</TD></TR><TR><TD CLASS="l">122</TD><TD>         *            oracle of the GWT compiler</TD></TR><TR><TD CLASS="l">123</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">124</TD><TD>        public Mvp4gConfiguration( TreeLogger logger, TypeOracle oracle ) {</TD></TR><TR CLASS="c"><TD CLASS="l">125</TD><TD>                this.logger = logger;</TD></TR><TR CLASS="c"><TD CLASS="l">126</TD><TD>                this.oracle = oracle;</TD></TR><TR CLASS="c"><TD CLASS="l">127</TD><TD>        }</TD></TR><TR><TD CLASS="l">128</TD><TD> </TD></TR><TR><TD CLASS="l">129</TD><TD>        /**</TD></TR><TR><TD CLASS="l">130</TD><TD>         * Loads all Mvp4g elements from an in-memory representation of the XML configuration and/or</TD></TR><TR><TD CLASS="l">131</TD><TD>         * annotations.&lt;/p&gt;</TD></TR><TR><TD CLASS="l">132</TD><TD>         * </TD></TR><TR><TD CLASS="l">133</TD><TD>         * Configuration loading comprises up to three phases:</TD></TR><TR><TD CLASS="l">134</TD><TD>         * </TD></TR><TR><TD CLASS="l">135</TD><TD>         * &lt;ol&gt;</TD></TR><TR><TD CLASS="l">136</TD><TD>         * &lt;li/&gt;Phase 1, &lt;i&gt;Parsing all the XML elements (if there is an XML configuration file)&lt;/i&gt;:</TD></TR><TR><TD CLASS="l">137</TD><TD>         * during this phase, all the Mvp4gElement instances are constructed from their corresponding</TD></TR><TR><TD CLASS="l">138</TD><TD>         * xml tags. Simple validation of element attributes is performed.</TD></TR><TR><TD CLASS="l">139</TD><TD>         * &lt;li/&gt;Phase 2, &lt;i&gt;Parsing all the annotations&lt;/i&gt;: during this phase, all the Mvp4gElement</TD></TR><TR><TD CLASS="l">140</TD><TD>         * instances are constructed from their corresponding annotations. All possible validations are</TD></TR><TR><TD CLASS="l">141</TD><TD>         * performed.</TD></TR><TR><TD CLASS="l">142</TD><TD>         * &lt;li/&gt;Phase 3, &lt;i&gt;Validation of cross-element references and removal of useless elements&lt;/i&gt;:</TD></TR><TR><TD CLASS="l">143</TD><TD>         * in this phase element identifiers are checked for global uniqueness; event handler references</TD></TR><TR><TD CLASS="l">144</TD><TD>         * and view references are checked for existence. Validity elements class is also checked.</TD></TR><TR><TD CLASS="l">145</TD><TD>         * &lt;/ol&gt;</TD></TR><TR><TD CLASS="l">146</TD><TD>         * </TD></TR><TR><TD CLASS="l">147</TD><TD>         * </TD></TR><TR><TD CLASS="l">148</TD><TD>         * @param module</TD></TR><TR><TD CLASS="l">149</TD><TD>         *            module to load</TD></TR><TR><TD CLASS="l">150</TD><TD>         * @param scanResult</TD></TR><TR><TD CLASS="l">151</TD><TD>         *            Map of classes associated with an annotation</TD></TR><TR><TD CLASS="l">152</TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">153</TD><TD>         *             this exception is thrown where a configuration error occurs.</TD></TR><TR><TD CLASS="l"><A NAME="1">154</A></TD><TD>         * </TD></TR><TR><TD CLASS="l">155</TD><TD>         */</TD></TR><TR><TD CLASS="l">156</TD><TD>        public void load( JClassType module, Map&lt;Class&lt;? extends Annotation&gt;, List&lt;JClassType&gt;&gt; scanResult ) throws InvalidMvp4gConfigurationException {</TD></TR><TR><TD CLASS="l">157</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">158</TD><TD>                this.module = module;</TD></TR><TR CLASS="z"><TD CLASS="l">159</TD><TD>                XmlFilePath xmlFilePath = module.getAnnotation( XmlFilePath.class );</TD></TR><TR><TD CLASS="l">160</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">161</TD><TD>                if ( xmlFilePath != null ) {</TD></TR><TR CLASS="z"><TD CLASS="l">162</TD><TD>                        InputStream input = getClass().getClassLoader().getResourceAsStream( xmlFilePath.value() );</TD></TR><TR><TD CLASS="l">163</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">164</TD><TD>                        if ( input != null ) {</TD></TR><TR><TD CLASS="l">165</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">166</TD><TD>                                XMLConfiguration xmlConfig = new XMLConfiguration();</TD></TR><TR><TD CLASS="l">167</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">168</TD><TD>                                        xmlConfig.load( input );</TD></TR><TR CLASS="z"><TD CLASS="l">169</TD><TD>                                } catch ( ConfigurationException e ) {</TD></TR><TR CLASS="z"><TD CLASS="l">170</TD><TD>                                        throw new InvalidMvp4gConfigurationException( e.getMessage() );</TD></TR><TR><TD CLASS="l">171</TD><TD>                                }</TD></TR><TR><TD CLASS="l">172</TD><TD> </TD></TR><TR><TD CLASS="l">173</TD><TD>                                // Phase 1: load all elements, performing attribute validation</TD></TR><TR><TD CLASS="l">174</TD><TD>                                try {</TD></TR><TR CLASS="z"><TD CLASS="l">175</TD><TD>                                        loadViews( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">176</TD><TD>                                        loadServices( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">177</TD><TD>                                        loadHistoryConverters( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">178</TD><TD>                                        loadPresenters( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">179</TD><TD>                                        loadEvents( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">180</TD><TD>                                        loadStart( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">181</TD><TD>                                        loadHistory( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">182</TD><TD>                                        loadChildConfig( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">183</TD><TD>                                        loadChildModules( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">184</TD><TD>                                        loadDebug( xmlConfig );</TD></TR><TR CLASS="z"><TD CLASS="l">185</TD><TD>                                } catch ( Mvp4gXmlException e ) {</TD></TR><TR CLASS="z"><TD CLASS="l">186</TD><TD>                                        e.setXmlFilePath( xmlFilePath.value() );</TD></TR><TR CLASS="z"><TD CLASS="l">187</TD><TD>                                        throw e;</TD></TR><TR><TD CLASS="l">188</TD><TD>                                }</TD></TR><TR><TD CLASS="l">189</TD><TD> </TD></TR><TR><TD CLASS="l">190</TD><TD>                        }</TD></TR><TR><TD CLASS="l">191</TD><TD>                }</TD></TR><TR><TD CLASS="l">192</TD><TD> </TD></TR><TR><TD CLASS="l">193</TD><TD>                // Phase 2: load information from annotations</TD></TR><TR CLASS="z"><TD CLASS="l">194</TD><TD>                loadServices( scanResult.get( Service.class ) );</TD></TR><TR CLASS="z"><TD CLASS="l">195</TD><TD>                loadHistoryConverters( scanResult.get( History.class ) );</TD></TR><TR CLASS="z"><TD CLASS="l">196</TD><TD>                loadPresenters( scanResult.get( Presenter.class ) );</TD></TR><TR CLASS="z"><TD CLASS="l">197</TD><TD>                loadEvents( scanResult.get( Events.class ) );</TD></TR><TR CLASS="z"><TD CLASS="l">198</TD><TD>                loadParentModule();</TD></TR><TR><TD CLASS="l">199</TD><TD> </TD></TR><TR><TD CLASS="l">200</TD><TD>                // Phase 3: perform cross-element validations</TD></TR><TR CLASS="z"><TD CLASS="l">201</TD><TD>                if ( eventBus == null ) {</TD></TR><TR CLASS="z"><TD CLASS="l">202</TD><TD>                        String err = &#34;No XML configuration or Event Bus interface has been found for &#34; + module.getSimpleSourceName()</TD></TR><TR CLASS="z"><TD CLASS="l">203</TD><TD>                                        + &#34; module. You need to define at least one of them.&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">204</TD><TD>                        throw new InvalidMvp4gConfigurationException( err );</TD></TR><TR><TD CLASS="l">205</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">206</TD><TD>                if ( eventBus.isXml() ) {</TD></TR><TR CLASS="z"><TD CLASS="l">207</TD><TD>                        findEventObjectClass();</TD></TR><TR><TD CLASS="l">208</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">209</TD><TD>                findChildModuleHistoryName();</TD></TR><TR CLASS="z"><TD CLASS="l">210</TD><TD>                checkUniquenessOfAllElements();</TD></TR><TR CLASS="z"><TD CLASS="l">211</TD><TD>                validateStart();</TD></TR><TR CLASS="z"><TD CLASS="l">212</TD><TD>                validateEventHandlers();</TD></TR><TR CLASS="z"><TD CLASS="l">213</TD><TD>                validateHistoryConverters();</TD></TR><TR CLASS="z"><TD CLASS="l">214</TD><TD>                validateViews();</TD></TR><TR CLASS="z"><TD CLASS="l">215</TD><TD>                validateServices();</TD></TR><TR CLASS="z"><TD CLASS="l">216</TD><TD>                validateEvents();</TD></TR><TR CLASS="z"><TD CLASS="l">217</TD><TD>                validateHistory();</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1d">218</A></TD><TD>                validateChildModules();</TD></TR><TR CLASS="z"><TD CLASS="l">219</TD><TD>        }</TD></TR><TR><TD CLASS="l">220</TD><TD> </TD></TR><TR><TD CLASS="l">221</TD><TD>        public boolean isAsyncEnabled() {</TD></TR><TR CLASS="c"><TD CLASS="l">222</TD><TD>                return ( oracle.findType( &#34;com.google.gwt.core.client.RunAsyncCallback&#34; ) != null );</TD></TR><TR><TD CLASS="l">223</TD><TD>        }</TD></TR><TR><TD CLASS="l">224</TD><TD> </TD></TR><TR><TD CLASS="l">225</TD><TD>        /*</TD></TR><TR><TD CLASS="l">226</TD><TD>         * GETTERS &amp; SETTERS</TD></TR><TR><TD CLASS="l">227</TD><TD>         */</TD></TR><TR><TD CLASS="l"><A NAME="17">228</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">229</TD><TD>         * @return a set of Presenters loaded.</TD></TR><TR><TD CLASS="l">230</TD><TD>         */</TD></TR><TR><TD CLASS="l">231</TD><TD>        public Set&lt;PresenterElement&gt; getPresenters() {</TD></TR><TR CLASS="c"><TD CLASS="l">232</TD><TD>                return presenters;</TD></TR><TR><TD CLASS="l">233</TD><TD>        }</TD></TR><TR><TD CLASS="l">234</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="1b">235</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">236</TD><TD>         * @return a set of Views loaded.</TD></TR><TR><TD CLASS="l">237</TD><TD>         */</TD></TR><TR><TD CLASS="l">238</TD><TD>        public Set&lt;ViewElement&gt; getViews() {</TD></TR><TR CLASS="c"><TD CLASS="l">239</TD><TD>                return views;</TD></TR><TR><TD CLASS="l">240</TD><TD>        }</TD></TR><TR><TD CLASS="l">241</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="f">242</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">243</TD><TD>         * @return a set of History Converters loaded.</TD></TR><TR><TD CLASS="l">244</TD><TD>         */</TD></TR><TR><TD CLASS="l">245</TD><TD>        public Set&lt;HistoryConverterElement&gt; getHistoryConverters() {</TD></TR><TR CLASS="c"><TD CLASS="l">246</TD><TD>                return historyConverters;</TD></TR><TR><TD CLASS="l">247</TD><TD>        }</TD></TR><TR><TD CLASS="l">248</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="d">249</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">250</TD><TD>         * @return a set of Events loaded.</TD></TR><TR><TD CLASS="l">251</TD><TD>         */</TD></TR><TR><TD CLASS="l">252</TD><TD>        public Set&lt;EventElement&gt; getEvents() {</TD></TR><TR CLASS="c"><TD CLASS="l">253</TD><TD>                return events;</TD></TR><TR><TD CLASS="l">254</TD><TD>        }</TD></TR><TR><TD CLASS="l">255</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="18">256</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">257</TD><TD>         * @return a set of Services loaded.</TD></TR><TR><TD CLASS="l">258</TD><TD>         */</TD></TR><TR><TD CLASS="l">259</TD><TD>        public Set&lt;ServiceElement&gt; getServices() {</TD></TR><TR CLASS="c"><TD CLASS="l">260</TD><TD>                return services;</TD></TR><TR><TD CLASS="l">261</TD><TD>        }</TD></TR><TR><TD CLASS="l">262</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="9">263</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">264</TD><TD>         * @return a set of Child Modules loaded</TD></TR><TR><TD CLASS="l">265</TD><TD>         */</TD></TR><TR><TD CLASS="l">266</TD><TD>        public Set&lt;ChildModuleElement&gt; getChildModules() {</TD></TR><TR CLASS="c"><TD CLASS="l">267</TD><TD>                return childModules;</TD></TR><TR><TD CLASS="l">268</TD><TD>        }</TD></TR><TR><TD CLASS="l">269</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="19">270</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">271</TD><TD>         * @return the Start element loaded.</TD></TR><TR><TD CLASS="l">272</TD><TD>         */</TD></TR><TR><TD CLASS="l">273</TD><TD>        public StartElement getStart() {</TD></TR><TR CLASS="c"><TD CLASS="l">274</TD><TD>                return start;</TD></TR><TR><TD CLASS="l">275</TD><TD>        }</TD></TR><TR><TD CLASS="l">276</TD><TD> </TD></TR><TR><TD CLASS="l">277</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="37">278</A></TD><TD>         * @param start</TD></TR><TR><TD CLASS="l">279</TD><TD>         *            the start to set</TD></TR><TR><TD CLASS="l">280</TD><TD>         */</TD></TR><TR><TD CLASS="l">281</TD><TD>        public void setStart( StartElement start ) {</TD></TR><TR CLASS="c"><TD CLASS="l">282</TD><TD>                this.start = start;</TD></TR><TR CLASS="c"><TD CLASS="l">283</TD><TD>        }</TD></TR><TR><TD CLASS="l">284</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="e">285</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">286</TD><TD>         * @return the History element loaded.</TD></TR><TR><TD CLASS="l">287</TD><TD>         */</TD></TR><TR><TD CLASS="l">288</TD><TD>        public HistoryElement getHistory() {</TD></TR><TR CLASS="c"><TD CLASS="l">289</TD><TD>                return history;</TD></TR><TR><TD CLASS="l">290</TD><TD>        }</TD></TR><TR><TD CLASS="l">291</TD><TD> </TD></TR><TR><TD CLASS="l">292</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="31">293</A></TD><TD>         * @param history</TD></TR><TR><TD CLASS="l">294</TD><TD>         *            the history to set</TD></TR><TR><TD CLASS="l">295</TD><TD>         */</TD></TR><TR><TD CLASS="l">296</TD><TD>        public void setHistory( HistoryElement history ) {</TD></TR><TR CLASS="c"><TD CLASS="l">297</TD><TD>                this.history = history;</TD></TR><TR CLASS="c"><TD CLASS="l">298</TD><TD>        }</TD></TR><TR><TD CLASS="l">299</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="c">300</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">301</TD><TD>         * @return the Event Bus element loaded</TD></TR><TR><TD CLASS="l">302</TD><TD>         */</TD></TR><TR><TD CLASS="l">303</TD><TD>        public EventBusElement getEventBus() {</TD></TR><TR CLASS="c"><TD CLASS="l">304</TD><TD>                return eventBus;</TD></TR><TR><TD CLASS="l">305</TD><TD>        }</TD></TR><TR><TD CLASS="l">306</TD><TD> </TD></TR><TR><TD CLASS="l">307</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="30">308</A></TD><TD>         * @param eventBus</TD></TR><TR><TD CLASS="l">309</TD><TD>         *            the eventBus to set</TD></TR><TR><TD CLASS="l">310</TD><TD>         */</TD></TR><TR><TD CLASS="l">311</TD><TD>        public void setEventBus( EventBusElement eventBus ) {</TD></TR><TR CLASS="c"><TD CLASS="l">312</TD><TD>                this.eventBus = eventBus;</TD></TR><TR CLASS="c"><TD CLASS="l">313</TD><TD>        }</TD></TR><TR><TD CLASS="l">314</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="13">315</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">316</TD><TD>         * @return the oracle</TD></TR><TR><TD CLASS="l">317</TD><TD>         */</TD></TR><TR><TD CLASS="l">318</TD><TD>        public TypeOracle getOracle() {</TD></TR><TR CLASS="c"><TD CLASS="l">319</TD><TD>                return oracle;</TD></TR><TR><TD CLASS="l">320</TD><TD>        }</TD></TR><TR><TD CLASS="l">321</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="12">322</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">323</TD><TD>         * @return the module</TD></TR><TR><TD CLASS="l">324</TD><TD>         */</TD></TR><TR><TD CLASS="l">325</TD><TD>        public JClassType getModule() {</TD></TR><TR CLASS="c"><TD CLASS="l">326</TD><TD>                return module;</TD></TR><TR><TD CLASS="l">327</TD><TD>        }</TD></TR><TR><TD CLASS="l">328</TD><TD> </TD></TR><TR><TD CLASS="l">329</TD><TD>        /**</TD></TR><TR><TD CLASS="l">330</TD><TD>         * Should be used only for test</TD></TR><TR><TD CLASS="l">331</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="34">332</A></TD><TD>         * @param module</TD></TR><TR><TD CLASS="l">333</TD><TD>         *            the module to set</TD></TR><TR><TD CLASS="l">334</TD><TD>         */</TD></TR><TR><TD CLASS="l">335</TD><TD>        public void setModule( JClassType module ) {</TD></TR><TR CLASS="c"><TD CLASS="l">336</TD><TD>                this.module = module;</TD></TR><TR CLASS="c"><TD CLASS="l">337</TD><TD>        }</TD></TR><TR><TD CLASS="l">338</TD><TD> </TD></TR><TR><TD CLASS="l">339</TD><TD>        /**</TD></TR><TR><TD CLASS="l">340</TD><TD>         * Should be used only for test</TD></TR><TR><TD CLASS="l">341</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="36">342</A></TD><TD>         * @param parentModule</TD></TR><TR><TD CLASS="l">343</TD><TD>         *            the parentModule to set</TD></TR><TR><TD CLASS="l">344</TD><TD>         */</TD></TR><TR><TD CLASS="l">345</TD><TD>        public void setParentModule( JClassType parentModule ) {</TD></TR><TR CLASS="c"><TD CLASS="l">346</TD><TD>                this.parentModule = parentModule;</TD></TR><TR CLASS="c"><TD CLASS="l">347</TD><TD>        }</TD></TR><TR><TD CLASS="l">348</TD><TD> </TD></TR><TR><TD CLASS="l">349</TD><TD>        /**</TD></TR><TR><TD CLASS="l">350</TD><TD>         * Should be used only for test</TD></TR><TR><TD CLASS="l">351</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="35">352</A></TD><TD>         * @param parentEventBus</TD></TR><TR><TD CLASS="l">353</TD><TD>         *            the parentEventBus to set</TD></TR><TR><TD CLASS="l">354</TD><TD>         */</TD></TR><TR><TD CLASS="l">355</TD><TD>        public void setParentEventBus( JClassType parentEventBus ) {</TD></TR><TR CLASS="c"><TD CLASS="l">356</TD><TD>                this.parentEventBus = parentEventBus;</TD></TR><TR CLASS="c"><TD CLASS="l">357</TD><TD>        }</TD></TR><TR><TD CLASS="l">358</TD><TD> </TD></TR><TR><TD CLASS="l">359</TD><TD>        /**</TD></TR><TR><TD CLASS="l">360</TD><TD>         * Should be used only for test</TD></TR><TR><TD CLASS="l">361</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="32">362</A></TD><TD>         * @param historyName</TD></TR><TR><TD CLASS="l">363</TD><TD>         *            the historyName to set</TD></TR><TR><TD CLASS="l">364</TD><TD>         */</TD></TR><TR><TD CLASS="l">365</TD><TD>        public void setHistoryName( String historyName ) {</TD></TR><TR CLASS="c"><TD CLASS="l">366</TD><TD>                this.historyName = historyName;</TD></TR><TR CLASS="c"><TD CLASS="l">367</TD><TD>        }</TD></TR><TR><TD CLASS="l">368</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="14">369</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">370</TD><TD>         * @return the childEventBusClassMap</TD></TR><TR><TD CLASS="l">371</TD><TD>         */</TD></TR><TR><TD CLASS="l">372</TD><TD>        public Map&lt;String, JClassType&gt; getOthersEventBusClassMap() {</TD></TR><TR CLASS="c"><TD CLASS="l">373</TD><TD>                return othersEventBusClassMap;</TD></TR><TR><TD CLASS="l">374</TD><TD>        }</TD></TR><TR><TD CLASS="l">375</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="11">376</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">377</TD><TD>         * @return the loadChildConfig</TD></TR><TR><TD CLASS="l">378</TD><TD>         */</TD></TR><TR><TD CLASS="l">379</TD><TD>        public ChildModulesElement getLoadChildConfig() {</TD></TR><TR CLASS="c"><TD CLASS="l">380</TD><TD>                return loadChildConfig;</TD></TR><TR><TD CLASS="l">381</TD><TD>        }</TD></TR><TR><TD CLASS="l">382</TD><TD> </TD></TR><TR><TD CLASS="l">383</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="33">384</A></TD><TD>         * @param loadChildConfig</TD></TR><TR><TD CLASS="l">385</TD><TD>         *            the loadChildConfig to set</TD></TR><TR><TD CLASS="l">386</TD><TD>         */</TD></TR><TR><TD CLASS="l">387</TD><TD>        public void setLoadChildConfig( ChildModulesElement loadChildConfig ) {</TD></TR><TR CLASS="c"><TD CLASS="l">388</TD><TD>                this.loadChildConfig = loadChildConfig;</TD></TR><TR CLASS="c"><TD CLASS="l">389</TD><TD>        }</TD></TR><TR><TD CLASS="l">390</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="16">391</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">392</TD><TD>         * @return the parentModule</TD></TR><TR><TD CLASS="l">393</TD><TD>         */</TD></TR><TR><TD CLASS="l">394</TD><TD>        public JClassType getParentModule() {</TD></TR><TR CLASS="c"><TD CLASS="l">395</TD><TD>                return parentModule;</TD></TR><TR><TD CLASS="l">396</TD><TD>        }</TD></TR><TR><TD CLASS="l">397</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="15">398</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">399</TD><TD>         * @return the parentEventBus</TD></TR><TR><TD CLASS="l">400</TD><TD>         */</TD></TR><TR><TD CLASS="l">401</TD><TD>        public JClassType getParentEventBus() {</TD></TR><TR CLASS="c"><TD CLASS="l">402</TD><TD>                return parentEventBus;</TD></TR><TR><TD CLASS="l">403</TD><TD>        }</TD></TR><TR><TD CLASS="l">404</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="10">405</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">406</TD><TD>         * @return the historyName</TD></TR><TR><TD CLASS="l">407</TD><TD>         */</TD></TR><TR><TD CLASS="l">408</TD><TD>        public String getHistoryName() {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="1e">409</A></TD><TD>                return historyName;</TD></TR><TR><TD CLASS="l">410</TD><TD>        }</TD></TR><TR><TD CLASS="l">411</TD><TD> </TD></TR><TR><TD CLASS="l">412</TD><TD>        public boolean isParentEventBusXml() {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="1c">413</A></TD><TD>                return ( parentEventBus != null ) &amp;&amp; ( parentEventBus.getQualifiedSourceName().equals( EventBusWithLookup.class.getCanonicalName() ) );</TD></TR><TR><TD CLASS="l">414</TD><TD>        }</TD></TR><TR><TD CLASS="l">415</TD><TD> </TD></TR><TR><TD CLASS="l">416</TD><TD>        public boolean hasParentModule( String moduleClassName ) {</TD></TR><TR CLASS="c"><TD CLASS="l">417</TD><TD>                return findParentModule( moduleClassName ) != null;</TD></TR><TR><TD CLASS="l">418</TD><TD>        }</TD></TR><TR><TD CLASS="l">419</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="a">420</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">421</TD><TD>         * @return the debug</TD></TR><TR><TD CLASS="l">422</TD><TD>         */</TD></TR><TR><TD CLASS="l">423</TD><TD>        public DebugElement getDebug() {</TD></TR><TR CLASS="c"><TD CLASS="l">424</TD><TD>                return debug;</TD></TR><TR><TD CLASS="l">425</TD><TD>        }</TD></TR><TR><TD CLASS="l">426</TD><TD> </TD></TR><TR><TD CLASS="l">427</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="2f">428</A></TD><TD>         * @param debug</TD></TR><TR><TD CLASS="l">429</TD><TD>         *            the debug to set</TD></TR><TR><TD CLASS="l">430</TD><TD>         */</TD></TR><TR><TD CLASS="l">431</TD><TD>        public void setDebug( DebugElement debug ) {</TD></TR><TR CLASS="c"><TD CLASS="l">432</TD><TD>                this.debug = debug;</TD></TR><TR CLASS="c"><TD CLASS="l">433</TD><TD>        }</TD></TR><TR><TD CLASS="l">434</TD><TD> </TD></TR><TR><TD CLASS="l">435</TD><TD>        /*</TD></TR><TR><TD CLASS="l">436</TD><TD>         * Validation</TD></TR><TR><TD CLASS="l">437</TD><TD>         */</TD></TR><TR><TD CLASS="l">438</TD><TD> </TD></TR><TR><TD CLASS="l">439</TD><TD>        /**</TD></TR><TR><TD CLASS="l">440</TD><TD>         * Checks that all injected views correspond to a configured mvp4g element. Remove views that</TD></TR><TR><TD CLASS="l">441</TD><TD>         * aren't injected into a presenter or loaded at start.&lt;/p&gt;</TD></TR><TR><TD CLASS="l">442</TD><TD>         * </TD></TR><TR><TD CLASS="l">443</TD><TD>         * @throws UnknownConfigurationElementException</TD></TR><TR><TD CLASS="l"><A NAME="3e">444</A></TD><TD>         *             if a view reference cannot be found among the configured elements.</TD></TR><TR><TD CLASS="l">445</TD><TD>         */</TD></TR><TR><TD CLASS="l">446</TD><TD>        void validateViews() throws UnknownConfigurationElementException {</TD></TR><TR><TD CLASS="l">447</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">448</TD><TD>                Map&lt;String, List&lt;PresenterElement&gt;&gt; viewMap = new HashMap&lt;String, List&lt;PresenterElement&gt;&gt;();</TD></TR><TR><TD CLASS="l">449</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">450</TD><TD>                List&lt;PresenterElement&gt; presenterList = null;</TD></TR><TR CLASS="c"><TD CLASS="l">451</TD><TD>                String viewName = null;</TD></TR><TR CLASS="c"><TD CLASS="l">452</TD><TD>                for ( PresenterElement presenter : presenters ) {</TD></TR><TR CLASS="c"><TD CLASS="l">453</TD><TD>                        viewName = presenter.getView();</TD></TR><TR CLASS="c"><TD CLASS="l">454</TD><TD>                        presenterList = viewMap.get( viewName );</TD></TR><TR CLASS="c"><TD CLASS="l">455</TD><TD>                        if ( presenterList == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">456</TD><TD>                                presenterList = new ArrayList&lt;PresenterElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">457</TD><TD>                                viewMap.put( viewName, presenterList );</TD></TR><TR><TD CLASS="l">458</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">459</TD><TD>                        presenterList.add( presenter );</TD></TR><TR><TD CLASS="l">460</TD><TD>                }</TD></TR><TR><TD CLASS="l">461</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">462</TD><TD>                Set&lt;ViewElement&gt; toRemove = new HashSet&lt;ViewElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">463</TD><TD>                String startView = start.getView();</TD></TR><TR CLASS="c"><TD CLASS="l">464</TD><TD>                for ( ViewElement view : views ) {</TD></TR><TR CLASS="c"><TD CLASS="l">465</TD><TD>                        viewName = view.getName();</TD></TR><TR CLASS="c"><TD CLASS="l">466</TD><TD>                        if ( ( viewMap.remove( viewName ) == null ) &amp;&amp; ( !startView.equals( viewName ) ) ) {</TD></TR><TR><TD CLASS="l">467</TD><TD>                                // this object is not used, you can remove it</TD></TR><TR CLASS="c"><TD CLASS="l">468</TD><TD>                                toRemove.add( view );</TD></TR><TR><TD CLASS="l">469</TD><TD>                        }</TD></TR><TR><TD CLASS="l">470</TD><TD>                }</TD></TR><TR><TD CLASS="l">471</TD><TD> </TD></TR><TR><TD CLASS="l">472</TD><TD>                // Missing view</TD></TR><TR CLASS="c"><TD CLASS="l">473</TD><TD>                if ( !viewMap.isEmpty() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">474</TD><TD>                        String it = viewMap.keySet().iterator().next();</TD></TR><TR CLASS="c"><TD CLASS="l">475</TD><TD>                        throw new UnknownConfigurationElementException( viewMap.get( it ).get( 0 ), it );</TD></TR><TR><TD CLASS="l">476</TD><TD>                }</TD></TR><TR><TD CLASS="l">477</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">478</TD><TD>                removeUselessElements( views, toRemove );</TD></TR><TR><TD CLASS="l">479</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">480</TD><TD>        }</TD></TR><TR><TD CLASS="l">481</TD><TD> </TD></TR><TR><TD CLASS="l">482</TD><TD>        /**</TD></TR><TR><TD CLASS="l">483</TD><TD>         * Checks that all service names injected on every presenter and history converter correspond to</TD></TR><TR><TD CLASS="l">484</TD><TD>         * a configured mvp4g element. Remove all services that aren't injected into a presenter or an</TD></TR><TR><TD CLASS="l">485</TD><TD>         * history converter.&lt;/p&gt;</TD></TR><TR><TD CLASS="l">486</TD><TD>         * </TD></TR><TR><TD CLASS="l">487</TD><TD>         * @throws UnknownConfigurationElementException</TD></TR><TR><TD CLASS="l"><A NAME="3c">488</A></TD><TD>         *             if a service cannot be found among the configured elements.</TD></TR><TR><TD CLASS="l">489</TD><TD>         */</TD></TR><TR><TD CLASS="l">490</TD><TD>        void validateServices() throws UnknownConfigurationElementException {</TD></TR><TR><TD CLASS="l">491</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">492</TD><TD>                Map&lt;String, List&lt;Mvp4gWithServicesElement&gt;&gt; serviceMap = new HashMap&lt;String, List&lt;Mvp4gWithServicesElement&gt;&gt;();</TD></TR><TR><TD CLASS="l">493</TD><TD> </TD></TR><TR><TD CLASS="l">494</TD><TD>                // Add presenter that handles event</TD></TR><TR CLASS="c"><TD CLASS="l">495</TD><TD>                List&lt;Mvp4gWithServicesElement&gt; elementList = null;</TD></TR><TR CLASS="c"><TD CLASS="l">496</TD><TD>                for ( PresenterElement presenter : presenters ) {</TD></TR><TR CLASS="c"><TD CLASS="l">497</TD><TD>                        for ( InjectedElement service : presenter.getInjectedServices() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">498</TD><TD>                                elementList = serviceMap.get( service.getElementName() );</TD></TR><TR CLASS="c"><TD CLASS="l">499</TD><TD>                                if ( elementList == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">500</TD><TD>                                        elementList = new ArrayList&lt;Mvp4gWithServicesElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">501</TD><TD>                                        serviceMap.put( service.getElementName(), elementList );</TD></TR><TR><TD CLASS="l">502</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">503</TD><TD>                                elementList.add( presenter );</TD></TR><TR><TD CLASS="l">504</TD><TD>                        }</TD></TR><TR><TD CLASS="l">505</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">506</TD><TD>                for ( HistoryConverterElement hc : historyConverters ) {</TD></TR><TR CLASS="c"><TD CLASS="l">507</TD><TD>                        for ( InjectedElement service : hc.getInjectedServices() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">508</TD><TD>                                elementList = serviceMap.get( service.getElementName() );</TD></TR><TR CLASS="c"><TD CLASS="l">509</TD><TD>                                if ( elementList == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">510</TD><TD>                                        elementList = new ArrayList&lt;Mvp4gWithServicesElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">511</TD><TD>                                        serviceMap.put( service.getElementName(), elementList );</TD></TR><TR><TD CLASS="l">512</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">513</TD><TD>                                elementList.add( hc );</TD></TR><TR><TD CLASS="l">514</TD><TD>                        }</TD></TR><TR><TD CLASS="l">515</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">516</TD><TD>                Set&lt;ServiceElement&gt; toRemove = new HashSet&lt;ServiceElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">517</TD><TD>                for ( ServiceElement service : services ) {</TD></TR><TR CLASS="c"><TD CLASS="l">518</TD><TD>                        if ( serviceMap.remove( service.getName() ) == null ) {</TD></TR><TR><TD CLASS="l">519</TD><TD>                                // this object is not used, you can remove it</TD></TR><TR CLASS="c"><TD CLASS="l">520</TD><TD>                                toRemove.add( service );</TD></TR><TR><TD CLASS="l">521</TD><TD>                        }</TD></TR><TR><TD CLASS="l">522</TD><TD>                }</TD></TR><TR><TD CLASS="l">523</TD><TD> </TD></TR><TR><TD CLASS="l">524</TD><TD>                // Missing service</TD></TR><TR CLASS="c"><TD CLASS="l">525</TD><TD>                if ( !serviceMap.isEmpty() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">526</TD><TD>                        String it = serviceMap.keySet().iterator().next();</TD></TR><TR CLASS="c"><TD CLASS="l">527</TD><TD>                        throw new UnknownConfigurationElementException( serviceMap.get( it ).get( 0 ), it );</TD></TR><TR><TD CLASS="l">528</TD><TD>                }</TD></TR><TR><TD CLASS="l">529</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">530</TD><TD>                removeUselessElements( services, toRemove );</TD></TR><TR><TD CLASS="l">531</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">532</TD><TD>        }</TD></TR><TR><TD CLASS="l">533</TD><TD> </TD></TR><TR><TD CLASS="l">534</TD><TD>        /**</TD></TR><TR><TD CLASS="l">535</TD><TD>         * Checks that all history converter names associated to each event is a configured mvp4g</TD></TR><TR><TD CLASS="l">536</TD><TD>         * element. Verify that these elements are valid. Remove all history converters that aren't used</TD></TR><TR><TD CLASS="l">537</TD><TD>         * by an event.</TD></TR><TR><TD CLASS="l">538</TD><TD>         * </TD></TR><TR><TD CLASS="l">539</TD><TD>         * </TD></TR><TR><TD CLASS="l">540</TD><TD>         * @throws InvalidClassException</TD></TR><TR><TD CLASS="l">541</TD><TD>         *             if an history converter don't implement History Converter</TD></TR><TR><TD CLASS="l">542</TD><TD>         * </TD></TR><TR><TD CLASS="l">543</TD><TD>         * @throws InvalidTypeException</TD></TR><TR><TD CLASS="l">544</TD><TD>         *             if the class of event bus and object used by history converter to convert is not</TD></TR><TR><TD CLASS="l">545</TD><TD>         *             compatible with the event bus of the module or the object class linked with the</TD></TR><TR><TD CLASS="l">546</TD><TD>         *             event.</TD></TR><TR><TD CLASS="l">547</TD><TD>         * </TD></TR><TR><TD CLASS="l">548</TD><TD>         * @throws UnknownConfigurationElementException</TD></TR><TR><TD CLASS="l">549</TD><TD>         *             if a history converter cannot be found among the configured elements.</TD></TR><TR><TD CLASS="l">550</TD><TD>         * </TD></TR><TR><TD CLASS="l">551</TD><TD>         * @throws NotFoundClassException</TD></TR><TR><TD CLASS="l"><A NAME="2">552</A></TD><TD>         *             if a class can not be found</TD></TR><TR><TD CLASS="l">553</TD><TD>         */</TD></TR><TR><TD CLASS="l">554</TD><TD>        void validateHistoryConverters() throws InvalidClassException, InvalidTypeException, UnknownConfigurationElementException, NotFoundClassException {</TD></TR><TR><TD CLASS="l">555</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">556</TD><TD>                Map&lt;String, List&lt;EventElement&gt;&gt; historyConverterMap = new HashMap&lt;String, List&lt;EventElement&gt;&gt;();</TD></TR><TR><TD CLASS="l">557</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">558</TD><TD>                List&lt;EventElement&gt; eventList = null;</TD></TR><TR CLASS="c"><TD CLASS="l">559</TD><TD>                String hcName = null;</TD></TR><TR CLASS="c"><TD CLASS="l">560</TD><TD>                for ( EventElement event : events ) {</TD></TR><TR CLASS="c"><TD CLASS="l">561</TD><TD>                        if ( event.hasHistory() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">562</TD><TD>                                hcName = event.getHistory();</TD></TR><TR CLASS="c"><TD CLASS="l">563</TD><TD>                                eventList = historyConverterMap.get( hcName );</TD></TR><TR CLASS="c"><TD CLASS="l">564</TD><TD>                                if ( eventList == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">565</TD><TD>                                        eventList = new ArrayList&lt;EventElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">566</TD><TD>                                        historyConverterMap.put( hcName, eventList );</TD></TR><TR><TD CLASS="l">567</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">568</TD><TD>                                eventList.add( event );</TD></TR><TR><TD CLASS="l">569</TD><TD>                        }</TD></TR><TR><TD CLASS="l">570</TD><TD>                }</TD></TR><TR><TD CLASS="l">571</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">572</TD><TD>                JGenericType hcGenType = getType( null, HistoryConverter.class.getCanonicalName() ).isGenericType();</TD></TR><TR CLASS="c"><TD CLASS="l">573</TD><TD>                JClassType eventBusType = getType( null, eventBus.getInterfaceClassName() );</TD></TR><TR CLASS="c"><TD CLASS="l">574</TD><TD>                String clearHistoryClassName = ClearHistory.class.getCanonicalName();</TD></TR><TR CLASS="c"><TD CLASS="l">575</TD><TD>                JClassType clearHistoryType = getType( null, clearHistoryClassName );</TD></TR><TR CLASS="c"><TD CLASS="l">576</TD><TD>                JClassType hcType = null;</TD></TR><TR CLASS="c"><TD CLASS="l">577</TD><TD>                JClassType eventBusParam = null;</TD></TR><TR CLASS="c"><TD CLASS="l">578</TD><TD>                JClassType objectClassParam = null;</TD></TR><TR CLASS="c"><TD CLASS="l">579</TD><TD>                String objectClass = null;</TD></TR><TR CLASS="c"><TD CLASS="l">580</TD><TD>                JMethod[] methods = null;</TD></TR><TR CLASS="c"><TD CLASS="l">581</TD><TD>                JParameterizedType genHC = null;</TD></TR><TR CLASS="c"><TD CLASS="l">582</TD><TD>                HistoryConverterElement clearHistoryToRemove = null;</TD></TR><TR><TD CLASS="l">583</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">584</TD><TD>                Set&lt;HistoryConverterElement&gt; toRemove = new HashSet&lt;HistoryConverterElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">585</TD><TD>                for ( HistoryConverterElement history : historyConverters ) {</TD></TR><TR CLASS="c"><TD CLASS="l">586</TD><TD>                        eventList = historyConverterMap.remove( history.getName() );</TD></TR><TR CLASS="c"><TD CLASS="l">587</TD><TD>                        if ( eventList != null ) {</TD></TR><TR><TD CLASS="l">588</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">589</TD><TD>                                hcType = getType( history, history.getClassName() );</TD></TR><TR><TD CLASS="l">590</TD><TD> </TD></TR><TR><TD CLASS="l">591</TD><TD>                                // if historyConverter is a ClearHistory instance, no control</TD></TR><TR><TD CLASS="l">592</TD><TD>                                // needed</TD></TR><TR CLASS="c"><TD CLASS="l">593</TD><TD>                                if ( !clearHistoryType.equals( hcType ) ) {</TD></TR><TR><TD CLASS="l">594</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">595</TD><TD>                                        genHC = hcType.asParameterizationOf( hcGenType );</TD></TR><TR CLASS="c"><TD CLASS="l">596</TD><TD>                                        if ( genHC == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">597</TD><TD>                                                throw new InvalidClassException( history, HistoryConverter.class.getCanonicalName() );</TD></TR><TR><TD CLASS="l">598</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">599</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">600</TD><TD>                                        methods = genHC.getMethods();</TD></TR><TR><TD CLASS="l">601</TD><TD> </TD></TR><TR><TD CLASS="l">602</TD><TD>                                        // Retrieve classes of History Converter event bus &amp; form</TD></TR><TR CLASS="c"><TD CLASS="l">603</TD><TD>                                        if ( &#34;convertFromToken&#34;.equals( methods[0].getName() ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">604</TD><TD>                                                eventBusParam = (JClassType)methods[0].getParameters()[2].getType();</TD></TR><TR CLASS="c"><TD CLASS="l">605</TD><TD>                                                objectClassParam = (JClassType)methods[1].getParameters()[1].getType();</TD></TR><TR><TD CLASS="l">606</TD><TD>                                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">607</TD><TD>                                                eventBusParam = (JClassType)methods[1].getParameters()[2].getType();</TD></TR><TR CLASS="z"><TD CLASS="l">608</TD><TD>                                                objectClassParam = (JClassType)methods[0].getParameters()[1].getType();</TD></TR><TR><TD CLASS="l">609</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">610</TD><TD> </TD></TR><TR><TD CLASS="l">611</TD><TD>                                        // Control if history converter event bus is compatible with</TD></TR><TR><TD CLASS="l">612</TD><TD>                                        // module event bus</TD></TR><TR CLASS="c"><TD CLASS="l">613</TD><TD>                                        if ( !eventBusType.isAssignableTo( eventBusParam ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">614</TD><TD>                                                throw new InvalidTypeException( history, &#34;Event Bus&#34;, eventBusParam.getQualifiedSourceName(), eventBus</TD></TR><TR CLASS="c"><TD CLASS="l">615</TD><TD>                                                                .getInterfaceClassName() );</TD></TR><TR><TD CLASS="l">616</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">617</TD><TD> </TD></TR><TR><TD CLASS="l">618</TD><TD>                                        // Control if event object class is compatible with History</TD></TR><TR><TD CLASS="l">619</TD><TD>                                        // Converter object class</TD></TR><TR CLASS="c"><TD CLASS="l">620</TD><TD>                                        for ( EventElement event : eventList ) {</TD></TR><TR CLASS="c"><TD CLASS="l">621</TD><TD>                                                objectClass = event.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">622</TD><TD>                                                if ( ( objectClass != null ) &amp;&amp; ( objectClass.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">623</TD><TD>                                                        if ( !getType( event, objectClass ).isAssignableTo( objectClassParam ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">624</TD><TD>                                                                throw new InvalidTypeException( event, &#34;History Converter&#34;, objectClassParam.getQualifiedSourceName(), objectClass );</TD></TR><TR><TD CLASS="l">625</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">626</TD><TD>                                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">627</TD><TD>                                                        logger.log( TreeLogger.WARN, String.format( HC_WARNING, history.getUniqueIdentifier(), event.getUniqueIdentifier() ) );</TD></TR><TR><TD CLASS="l">628</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">629</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">630</TD><TD>                                }</TD></TR><TR><TD CLASS="l">631</TD><TD>                        } else {</TD></TR><TR CLASS="c"><TD CLASS="l">632</TD><TD>                                if ( !clearHistoryClassName.equals( history.getClassName() ) ) {</TD></TR><TR><TD CLASS="l">633</TD><TD>                                        // this object is not used, you can remove it</TD></TR><TR CLASS="c"><TD CLASS="l">634</TD><TD>                                        toRemove.add( history );</TD></TR><TR><TD CLASS="l">635</TD><TD>                                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">636</TD><TD>                                        clearHistoryToRemove = history;</TD></TR><TR><TD CLASS="l">637</TD><TD>                                }</TD></TR><TR><TD CLASS="l">638</TD><TD>                        }</TD></TR><TR><TD CLASS="l">639</TD><TD>                }</TD></TR><TR><TD CLASS="l">640</TD><TD> </TD></TR><TR><TD CLASS="l">641</TD><TD>                // Missing history converter</TD></TR><TR CLASS="c"><TD CLASS="l">642</TD><TD>                if ( !historyConverterMap.isEmpty() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">643</TD><TD>                        String it = historyConverterMap.keySet().iterator().next();</TD></TR><TR CLASS="c"><TD CLASS="l">644</TD><TD>                        throw new UnknownConfigurationElementException( historyConverterMap.get( it ).get( 0 ), it );</TD></TR><TR><TD CLASS="l">645</TD><TD>                }</TD></TR><TR><TD CLASS="l">646</TD><TD> </TD></TR><TR><TD CLASS="l">647</TD><TD>                // remove clear history (you don't want this to appear on log)</TD></TR><TR CLASS="c"><TD CLASS="l">648</TD><TD>                if ( clearHistoryToRemove != null ) {</TD></TR><TR CLASS="z"><TD CLASS="l">649</TD><TD>                        historyConverters.remove( clearHistoryToRemove );</TD></TR><TR><TD CLASS="l">650</TD><TD>                }</TD></TR><TR><TD CLASS="l">651</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">652</TD><TD>                removeUselessElements( historyConverters, toRemove );</TD></TR><TR><TD CLASS="l">653</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">654</TD><TD>        }</TD></TR><TR><TD CLASS="l">655</TD><TD> </TD></TR><TR><TD CLASS="l">656</TD><TD>        /**</TD></TR><TR><TD CLASS="l">657</TD><TD>         * Checks that all event handler names correspond to a configured mvp4g element. Verify that</TD></TR><TR><TD CLASS="l">658</TD><TD>         * these elements are valid. Remove the ones that don't handle events or aren't associated with</TD></TR><TR><TD CLASS="l">659</TD><TD>         * the start view.&lt;/p&gt;</TD></TR><TR><TD CLASS="l">660</TD><TD>         * </TD></TR><TR><TD CLASS="l">661</TD><TD>         * @throws UnknownConfigurationElementException</TD></TR><TR><TD CLASS="l">662</TD><TD>         *             if an event handler cannot be found among the configured elements.</TD></TR><TR><TD CLASS="l">663</TD><TD>         * </TD></TR><TR><TD CLASS="l">664</TD><TD>         * @throws InvalidTypeException</TD></TR><TR><TD CLASS="l">665</TD><TD>         *             if the class of event bus or view injected in the presenter is not compatible</TD></TR><TR><TD CLASS="l">666</TD><TD>         *             with the event bus/view managed by the presenter.</TD></TR><TR><TD CLASS="l">667</TD><TD>         * </TD></TR><TR><TD CLASS="l">668</TD><TD>         * @throws InvalidClassException</TD></TR><TR><TD CLASS="l">669</TD><TD>         *             if presenter element class doesn't implement PresenterInterface.</TD></TR><TR><TD CLASS="l">670</TD><TD>         * </TD></TR><TR><TD CLASS="l">671</TD><TD>         * @throws NotFoundClassException</TD></TR><TR><TD CLASS="l"><A NAME="39">672</A></TD><TD>         *             if a class can not be found</TD></TR><TR><TD CLASS="l">673</TD><TD>         */</TD></TR><TR><TD CLASS="l">674</TD><TD>        void validateEventHandlers() throws UnknownConfigurationElementException, InvalidTypeException, InvalidClassException, NotFoundClassException {</TD></TR><TR><TD CLASS="l">675</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">676</TD><TD>                Map&lt;String, List&lt;EventElement&gt;&gt; presenterMap = new HashMap&lt;String, List&lt;EventElement&gt;&gt;();</TD></TR><TR><TD CLASS="l">677</TD><TD> </TD></TR><TR><TD CLASS="l">678</TD><TD>                // Add presenter that handles event</TD></TR><TR CLASS="c"><TD CLASS="l">679</TD><TD>                List&lt;EventElement&gt; eventList = null;</TD></TR><TR CLASS="c"><TD CLASS="l">680</TD><TD>                for ( EventElement event : events ) {</TD></TR><TR CLASS="c"><TD CLASS="l">681</TD><TD>                        for ( String handler : event.getHandlers() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">682</TD><TD>                                eventList = presenterMap.get( handler );</TD></TR><TR CLASS="c"><TD CLASS="l">683</TD><TD>                                if ( eventList == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">684</TD><TD>                                        eventList = new ArrayList&lt;EventElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">685</TD><TD>                                        presenterMap.put( handler, eventList );</TD></TR><TR><TD CLASS="l">686</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">687</TD><TD>                                eventList.add( event );</TD></TR><TR><TD CLASS="l">688</TD><TD>                        }</TD></TR><TR><TD CLASS="l">689</TD><TD>                }</TD></TR><TR><TD CLASS="l">690</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">691</TD><TD>                String startView = start.getView();</TD></TR><TR CLASS="c"><TD CLASS="l">692</TD><TD>                JGenericType presenterGenType = getType( null, PresenterInterface.class.getCanonicalName() ).isGenericType();</TD></TR><TR CLASS="c"><TD CLASS="l">693</TD><TD>                JClassType eventBusType = getType( null, eventBus.getInterfaceClassName() );</TD></TR><TR CLASS="c"><TD CLASS="l">694</TD><TD>                JType[] noParam = new JType[0];</TD></TR><TR CLASS="c"><TD CLASS="l">695</TD><TD>                JClassType presenterType = null;</TD></TR><TR CLASS="c"><TD CLASS="l">696</TD><TD>                JClassType eventBusParam = null;</TD></TR><TR CLASS="c"><TD CLASS="l">697</TD><TD>                JClassType viewParam = null;</TD></TR><TR CLASS="c"><TD CLASS="l">698</TD><TD>                String viewName = null;</TD></TR><TR CLASS="c"><TD CLASS="l">699</TD><TD>                ViewElement view = null;</TD></TR><TR CLASS="c"><TD CLASS="l">700</TD><TD>                JParameterizedType genPresenter = null;</TD></TR><TR><TD CLASS="l">701</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">702</TD><TD>                Set&lt;PresenterElement&gt; toRemove = new HashSet&lt;PresenterElement&gt;();</TD></TR><TR><TD CLASS="l">703</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">704</TD><TD>                for ( PresenterElement presenter : presenters ) {</TD></TR><TR CLASS="c"><TD CLASS="l">705</TD><TD>                        eventList = presenterMap.remove( presenter.getName() );</TD></TR><TR CLASS="c"><TD CLASS="l">706</TD><TD>                        viewName = presenter.getView();</TD></TR><TR CLASS="c"><TD CLASS="l">707</TD><TD>                        if ( eventList != null || viewName.equals( startView ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">708</TD><TD>                                presenterType = getType( presenter, presenter.getClassName() );</TD></TR><TR CLASS="c"><TD CLASS="l">709</TD><TD>                                genPresenter = presenterType.asParameterizationOf( presenterGenType );</TD></TR><TR CLASS="c"><TD CLASS="l">710</TD><TD>                                if ( genPresenter == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">711</TD><TD>                                        throw new InvalidClassException( presenter, PresenterInterface.class.getCanonicalName() );</TD></TR><TR><TD CLASS="l">712</TD><TD>                                }</TD></TR><TR><TD CLASS="l">713</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">714</TD><TD>                                eventBusParam = (JClassType)genPresenter.findMethod( &#34;getEventBus&#34;, noParam ).getReturnType();</TD></TR><TR CLASS="c"><TD CLASS="l">715</TD><TD>                                viewParam = (JClassType)genPresenter.findMethod( &#34;getView&#34;, noParam ).getReturnType();</TD></TR><TR><TD CLASS="l">716</TD><TD> </TD></TR><TR><TD CLASS="l">717</TD><TD>                                // Control if presenter event bus is compatible with module</TD></TR><TR><TD CLASS="l">718</TD><TD>                                // event bus</TD></TR><TR CLASS="c"><TD CLASS="l">719</TD><TD>                                if ( !eventBusType.isAssignableTo( eventBusParam ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">720</TD><TD>                                        throw new InvalidTypeException( presenter, &#34;Event Bus&#34;, eventBus.getInterfaceClassName(), eventBusParam.getQualifiedSourceName() );</TD></TR><TR><TD CLASS="l">721</TD><TD>                                }</TD></TR><TR><TD CLASS="l">722</TD><TD> </TD></TR><TR><TD CLASS="l">723</TD><TD>                                // Control if view injected to the event bus is compatible with</TD></TR><TR><TD CLASS="l">724</TD><TD>                                // presenter view type</TD></TR><TR CLASS="c"><TD CLASS="l">725</TD><TD>                                view = getElement( viewName, views, presenter );</TD></TR><TR><TD CLASS="l">726</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">727</TD><TD>                                if ( !getType( view, view.getClassName() ).isAssignableTo( viewParam ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">728</TD><TD>                                        throw new InvalidTypeException( presenter, &#34;View&#34;, view.getClassName(), viewParam.getQualifiedSourceName() );</TD></TR><TR><TD CLASS="l">729</TD><TD>                                }</TD></TR><TR><TD CLASS="l">730</TD><TD> </TD></TR><TR><TD CLASS="l">731</TD><TD>                        } else {</TD></TR><TR><TD CLASS="l">732</TD><TD>                                // this object is not used, you can remove it</TD></TR><TR CLASS="c"><TD CLASS="l">733</TD><TD>                                toRemove.add( presenter );</TD></TR><TR><TD CLASS="l">734</TD><TD>                        }</TD></TR><TR><TD CLASS="l">735</TD><TD>                }</TD></TR><TR><TD CLASS="l">736</TD><TD> </TD></TR><TR><TD CLASS="l">737</TD><TD>                // Missing presenter</TD></TR><TR CLASS="c"><TD CLASS="l">738</TD><TD>                if ( !presenterMap.isEmpty() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">739</TD><TD>                        String it = presenterMap.keySet().iterator().next();</TD></TR><TR CLASS="c"><TD CLASS="l">740</TD><TD>                        throw new UnknownConfigurationElementException( presenterMap.get( it ).get( 0 ), it );</TD></TR><TR><TD CLASS="l">741</TD><TD>                }</TD></TR><TR><TD CLASS="l">742</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">743</TD><TD>                removeUselessElements( presenters, toRemove );</TD></TR><TR><TD CLASS="l">744</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="38">745</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">746</TD><TD> </TD></TR><TR><TD CLASS="l">747</TD><TD>        void validateChildModules() throws InvalidMvp4gConfigurationException {</TD></TR><TR><TD CLASS="l">748</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">749</TD><TD>                Map&lt;String, List&lt;EventElement&gt;&gt; childModuleMap = new HashMap&lt;String, List&lt;EventElement&gt;&gt;();</TD></TR><TR><TD CLASS="l">750</TD><TD> </TD></TR><TR><TD CLASS="l">751</TD><TD>                // Add presenter that handles event</TD></TR><TR CLASS="c"><TD CLASS="l">752</TD><TD>                List&lt;EventElement&gt; eventList = null;</TD></TR><TR CLASS="c"><TD CLASS="l">753</TD><TD>                for ( EventElement event : events ) {</TD></TR><TR CLASS="c"><TD CLASS="l">754</TD><TD>                        for ( String childModule : event.getModulesToLoad() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">755</TD><TD>                                eventList = childModuleMap.get( childModule );</TD></TR><TR CLASS="c"><TD CLASS="l">756</TD><TD>                                if ( eventList == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">757</TD><TD>                                        eventList = new ArrayList&lt;EventElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">758</TD><TD>                                        childModuleMap.put( childModule, eventList );</TD></TR><TR><TD CLASS="l">759</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">760</TD><TD>                                eventList.add( event );</TD></TR><TR><TD CLASS="l">761</TD><TD>                        }</TD></TR><TR><TD CLASS="l">762</TD><TD>                }</TD></TR><TR><TD CLASS="l">763</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">764</TD><TD>                JClassType moduleSuperClass = getType( null, Mvp4gModule.class.getCanonicalName() );</TD></TR><TR CLASS="c"><TD CLASS="l">765</TD><TD>                JClassType moduleType = null;</TD></TR><TR><TD CLASS="l">766</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">767</TD><TD>                Set&lt;ChildModuleElement&gt; toRemove = new HashSet&lt;ChildModuleElement&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">768</TD><TD>                String eventName = null;</TD></TR><TR CLASS="c"><TD CLASS="l">769</TD><TD>                EventElement eventElt = null;</TD></TR><TR CLASS="c"><TD CLASS="l">770</TD><TD>                String eventObjClass = null;</TD></TR><TR CLASS="c"><TD CLASS="l">771</TD><TD>                String childModuleClass = null;</TD></TR><TR CLASS="c"><TD CLASS="l">772</TD><TD>                JClassType childEventBus = null;</TD></TR><TR CLASS="c"><TD CLASS="l">773</TD><TD>                String startViewClass = null;</TD></TR><TR CLASS="c"><TD CLASS="l">774</TD><TD>                for ( ChildModuleElement childModule : childModules ) {</TD></TR><TR CLASS="c"><TD CLASS="l">775</TD><TD>                        eventList = childModuleMap.remove( childModule.getName() );</TD></TR><TR CLASS="c"><TD CLASS="l">776</TD><TD>                        if ( eventList != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">777</TD><TD>                                childModuleClass = childModule.getClassName();</TD></TR><TR CLASS="c"><TD CLASS="l">778</TD><TD>                                moduleType = getType( childModule, childModuleClass );</TD></TR><TR CLASS="c"><TD CLASS="l">779</TD><TD>                                if ( !moduleType.isAssignableTo( moduleSuperClass ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">780</TD><TD>                                        throw new InvalidClassException( childModule, Mvp4gModule.class.getCanonicalName() );</TD></TR><TR><TD CLASS="l">781</TD><TD>                                }</TD></TR><TR><TD CLASS="l">782</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">783</TD><TD>                                if ( childModule.isAutoDisplay() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">784</TD><TD>                                        eventName = childModule.getEventToDisplayView();</TD></TR><TR CLASS="c"><TD CLASS="l">785</TD><TD>                                        if ( ( eventName == null ) || ( eventName.length() == 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">786</TD><TD>                                                String error = String.format( MISSING_ATTRIBUTE, module.getQualifiedSourceName(), childModule.getClassName() );</TD></TR><TR CLASS="c"><TD CLASS="l">787</TD><TD>                                                throw new InvalidMvp4gConfigurationException( error );</TD></TR><TR><TD CLASS="l">788</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">789</TD><TD>                                        // verify event exists</TD></TR><TR CLASS="c"><TD CLASS="l">790</TD><TD>                                        eventElt = getElement( eventName, events, childModule );</TD></TR><TR CLASS="c"><TD CLASS="l">791</TD><TD>                                        eventObjClass = eventElt.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">792</TD><TD>                                        if ( ( eventObjClass == null ) || ( eventObjClass.length() == 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">793</TD><TD>                                                throw new InvalidMvp4gConfigurationException( String.format( EMPTY_EVENT_OBJ, eventElt.getType() ) );</TD></TR><TR><TD CLASS="l">794</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">795</TD><TD>                                        childEventBus = othersEventBusClassMap.get( childModuleClass );</TD></TR><TR CLASS="c"><TD CLASS="l">796</TD><TD>                                        if ( childEventBus != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">797</TD><TD>                                                startViewClass = childEventBus.getAnnotation( Events.class ).startView().getCanonicalName();</TD></TR><TR CLASS="c"><TD CLASS="l">798</TD><TD>                                                if ( !getType( childModule, startViewClass ).isAssignableTo( getType( eventElt, eventElt.getEventObjectClass() ) ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">799</TD><TD>                                                        throw new InvalidMvp4gConfigurationException( String.format( WRONG_CHILD_LOAD_EVENT_OBJ, childModule.getClassName(),</TD></TR><TR CLASS="c"><TD CLASS="l">800</TD><TD>                                                                        eventElt.getType(), startViewClass, eventElt.getEventObjectClass() ) );</TD></TR><TR><TD CLASS="l">801</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">802</TD><TD>                                        } else {</TD></TR><TR CLASS="c"><TD CLASS="l">803</TD><TD>                                                logger.log( TreeLogger.WARN, String.format( START_VIEW_XML_WARNING, childModule.getClassName(), eventElt.getType() ) );</TD></TR><TR><TD CLASS="l">804</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">805</TD><TD>                                }</TD></TR><TR><TD CLASS="l">806</TD><TD>                        } else {</TD></TR><TR><TD CLASS="l">807</TD><TD>                                // this object is not used, you can remove it</TD></TR><TR CLASS="c"><TD CLASS="l">808</TD><TD>                                toRemove.add( childModule );</TD></TR><TR><TD CLASS="l">809</TD><TD>                        }</TD></TR><TR><TD CLASS="l">810</TD><TD>                }</TD></TR><TR><TD CLASS="l">811</TD><TD> </TD></TR><TR><TD CLASS="l">812</TD><TD>                // Missing presenter</TD></TR><TR CLASS="c"><TD CLASS="l">813</TD><TD>                if ( !childModuleMap.isEmpty() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">814</TD><TD>                        String it = childModuleMap.keySet().iterator().next();</TD></TR><TR CLASS="c"><TD CLASS="l">815</TD><TD>                        throw new UnknownConfigurationElementException( childModuleMap.get( it ).get( 0 ), it );</TD></TR><TR><TD CLASS="l">816</TD><TD>                }</TD></TR><TR><TD CLASS="l">817</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">818</TD><TD>                removeUselessElements( childModules, toRemove );</TD></TR><TR><TD CLASS="l">819</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">820</TD><TD>        }</TD></TR><TR><TD CLASS="l">821</TD><TD> </TD></TR><TR><TD CLASS="l">822</TD><TD>        /**</TD></TR><TR><TD CLASS="l">823</TD><TD>         * Checks that events dispatch at start or History correspond to a configured mvp4g element.</TD></TR><TR><TD CLASS="l">824</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="3a">825</A></TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">826</TD><TD>         */</TD></TR><TR><TD CLASS="l">827</TD><TD>        void validateEvents() throws InvalidMvp4gConfigurationException {</TD></TR><TR><TD CLASS="l">828</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">829</TD><TD>                for ( EventElement event : events ) {</TD></TR><TR CLASS="c"><TD CLASS="l">830</TD><TD>                        if ( event.hasForwardToParent() &amp;&amp; ( parentModule == null ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">831</TD><TD>                                throw new InvalidMvp4gConfigurationException( String.format( NO_PARENT_ERROR, event.getType() ) );</TD></TR><TR><TD CLASS="l">832</TD><TD>                        }</TD></TR><TR><TD CLASS="l">833</TD><TD>                }</TD></TR><TR><TD CLASS="l">834</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">835</TD><TD>                String event = null;</TD></TR><TR CLASS="c"><TD CLASS="l">836</TD><TD>                if ( start.hasEventType() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">837</TD><TD>                        event = start.getEventType();</TD></TR><TR CLASS="c"><TD CLASS="l">838</TD><TD>                        getElement( event, events, start );</TD></TR><TR><TD CLASS="l">839</TD><TD>                }</TD></TR><TR><TD CLASS="l">840</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">841</TD><TD>                if ( ( history != null ) &amp;&amp; ( parentModule == null ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">842</TD><TD>                        event = history.getInitEvent();</TD></TR><TR CLASS="c"><TD CLASS="l">843</TD><TD>                        getElement( event, events, history );</TD></TR><TR><TD CLASS="l">844</TD><TD>                }</TD></TR><TR><TD CLASS="l">845</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">846</TD><TD>                if ( loadChildConfig != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">847</TD><TD>                        EventElement eventElt = null;</TD></TR><TR CLASS="c"><TD CLASS="l">848</TD><TD>                        String objClass = null;</TD></TR><TR CLASS="c"><TD CLASS="l">849</TD><TD>                        String eventName = loadChildConfig.getErrorEvent();</TD></TR><TR CLASS="c"><TD CLASS="l">850</TD><TD>                        if ( ( eventName != null ) &amp;&amp; ( eventName.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">851</TD><TD>                                eventElt = getElement( eventName, events, loadChildConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">852</TD><TD>                                objClass = eventElt.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">853</TD><TD>                                if ( ( objClass != null ) &amp;&amp; ( !Throwable.class.getName().equals( objClass ) ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">854</TD><TD>                                        throw new InvalidMvp4gConfigurationException( String.format( WRONG_EVENT_OBJ, loadChildConfig.getTagName(), &#34;Error&#34;, eventElt</TD></TR><TR CLASS="c"><TD CLASS="l">855</TD><TD>                                                        .getType(), Throwable.class.getName() ) );</TD></TR><TR><TD CLASS="l">856</TD><TD>                                }</TD></TR><TR><TD CLASS="l">857</TD><TD>                        }</TD></TR><TR><TD CLASS="l">858</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">859</TD><TD>                        eventName = loadChildConfig.getAfterEvent();</TD></TR><TR CLASS="c"><TD CLASS="l">860</TD><TD>                        if ( ( eventName != null ) &amp;&amp; ( eventName.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">861</TD><TD>                                eventElt = getElement( eventName, events, loadChildConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">862</TD><TD>                                objClass = eventElt.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">863</TD><TD>                                if ( ( objClass != null ) &amp;&amp; ( objClass.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">864</TD><TD>                                        throw new InvalidMvp4gConfigurationException( String.format( NOT_EMPTY_EVENT_OBJ, loadChildConfig.getTagName(), &#34;After&#34;, eventElt</TD></TR><TR CLASS="c"><TD CLASS="l">865</TD><TD>                                                        .getType() ) );</TD></TR><TR><TD CLASS="l">866</TD><TD>                                }</TD></TR><TR><TD CLASS="l">867</TD><TD>                        }</TD></TR><TR><TD CLASS="l">868</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">869</TD><TD>                        eventName = loadChildConfig.getBeforeEvent();</TD></TR><TR CLASS="c"><TD CLASS="l">870</TD><TD>                        if ( ( eventName != null ) &amp;&amp; ( eventName.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">871</TD><TD>                                eventElt = getElement( eventName, events, loadChildConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">872</TD><TD>                                objClass = eventElt.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">873</TD><TD>                                if ( ( objClass != null ) &amp;&amp; ( objClass.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">874</TD><TD>                                        throw new InvalidMvp4gConfigurationException( String.format( NOT_EMPTY_EVENT_OBJ, loadChildConfig.getTagName(), &#34;Before&#34;,</TD></TR><TR CLASS="c"><TD CLASS="l">875</TD><TD>                                                        eventElt.getType() ) );</TD></TR><TR><TD CLASS="l">876</TD><TD>                                }</TD></TR><TR><TD CLASS="l">877</TD><TD>                        }</TD></TR><TR><TD CLASS="l">878</TD><TD> </TD></TR><TR><TD CLASS="l">879</TD><TD>                }</TD></TR><TR><TD CLASS="l">880</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">881</TD><TD>        }</TD></TR><TR><TD CLASS="l">882</TD><TD> </TD></TR><TR><TD CLASS="l">883</TD><TD>        /**</TD></TR><TR><TD CLASS="l">884</TD><TD>         * Validate that if history converters are used, init history event is defined</TD></TR><TR><TD CLASS="l">885</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="3b">886</A></TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">887</TD><TD>         *             if history init event is not defined but history converters are used</TD></TR><TR><TD CLASS="l">888</TD><TD>         */</TD></TR><TR><TD CLASS="l">889</TD><TD>        void validateHistory() throws InvalidMvp4gConfigurationException {</TD></TR><TR CLASS="c"><TD CLASS="l">890</TD><TD>                if ( historyConverters.size() &gt; 0 ) {</TD></TR><TR CLASS="c"><TD CLASS="l">891</TD><TD>                        if ( parentModule != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">892</TD><TD>                                if ( ( history != null ) &amp;&amp; ( ( history.getInitEvent() != null ) || ( history.getNotFoundEvent() != null ) ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">893</TD><TD>                                        throw new InvalidMvp4gConfigurationException(</TD></TR><TR CLASS="c"><TD CLASS="l">894</TD><TD>                                                        &#34;History configuration (init and not found event should be configure only for root module (only module with no parent)&#34; );</TD></TR><TR><TD CLASS="l">895</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">896</TD><TD>                                if ( ( historyName == null ) || ( historyName.length() == 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">897</TD><TD>                                        throw new InvalidMvp4gConfigurationException( &#34;Child module that defines history converter must have a @HistoryName annotation.&#34; );</TD></TR><TR><TD CLASS="l">898</TD><TD>                                }</TD></TR><TR><TD CLASS="l">899</TD><TD>                                // make sure history is equal to null for the writer</TD></TR><TR CLASS="c"><TD CLASS="l">900</TD><TD>                                history = null;</TD></TR><TR><TD CLASS="l">901</TD><TD>                        } else {</TD></TR><TR CLASS="c"><TD CLASS="l">902</TD><TD>                                if ( ( history == null ) || ( history.getInitEvent() == null ) || ( history.getInitEvent().length() == 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">903</TD><TD>                                        throw new InvalidMvp4gConfigurationException( &#34;You must define a History init event if you use history converters.&#34; );</TD></TR><TR><TD CLASS="l">904</TD><TD>                                }</TD></TR><TR><TD CLASS="l">905</TD><TD>                        }</TD></TR><TR><TD CLASS="l">906</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">907</TD><TD>        }</TD></TR><TR><TD CLASS="l">908</TD><TD> </TD></TR><TR><TD CLASS="l">909</TD><TD>        /**</TD></TR><TR><TD CLASS="l">910</TD><TD>         * Validates that every mvp4g element has a globally unique identifier.&lt;/p&gt;</TD></TR><TR><TD CLASS="l">911</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="8">912</A></TD><TD>         * @throws NonUniqueIdentifierExcpetion</TD></TR><TR><TD CLASS="l">913</TD><TD>         *             if two or more elements have the same textual identifier.</TD></TR><TR><TD CLASS="l">914</TD><TD>         */</TD></TR><TR><TD CLASS="l">915</TD><TD>        void checkUniquenessOfAllElements() throws NonUniqueIdentifierException {</TD></TR><TR CLASS="c"><TD CLASS="l">916</TD><TD>                Set&lt;String&gt; allIds = new HashSet&lt;String&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">917</TD><TD>                checkUniquenessOf( historyConverters, allIds );</TD></TR><TR CLASS="c"><TD CLASS="l">918</TD><TD>                checkUniquenessOf( presenters, allIds );</TD></TR><TR CLASS="c"><TD CLASS="l">919</TD><TD>                checkUniquenessOf( views, allIds );</TD></TR><TR CLASS="c"><TD CLASS="l">920</TD><TD>                checkUniquenessOf( events, allIds );</TD></TR><TR CLASS="c"><TD CLASS="l">921</TD><TD>                checkUniquenessOf( services, allIds );</TD></TR><TR CLASS="c"><TD CLASS="l">922</TD><TD>                checkUniquenessOf( childModules, allIds );</TD></TR><TR CLASS="c"><TD CLASS="l">923</TD><TD>        }</TD></TR><TR><TD CLASS="l">924</TD><TD> </TD></TR><TR><TD CLASS="l">925</TD><TD>        /**</TD></TR><TR><TD CLASS="l">926</TD><TD>         * Validate start element</TD></TR><TR><TD CLASS="l">927</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="3d">928</A></TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">929</TD><TD>         *             thrown if no view to load at start has been defined.</TD></TR><TR><TD CLASS="l">930</TD><TD>         */</TD></TR><TR><TD CLASS="l">931</TD><TD>        void validateStart() throws InvalidMvp4gConfigurationException {</TD></TR><TR CLASS="c"><TD CLASS="l">932</TD><TD>                if ( ( start == null ) || ( start.getView() == null ) || ( start.getView().length() == 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">933</TD><TD>                        throw new InvalidMvp4gConfigurationException( &#34;You must define a view to load when the application starts.&#34; );</TD></TR><TR><TD CLASS="l">934</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">935</TD><TD>                String startEvent = start.getEventType();</TD></TR><TR CLASS="c"><TD CLASS="l">936</TD><TD>                if ( ( startEvent != null ) &amp;&amp; ( startEvent.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">937</TD><TD>                        EventElement eventElt = getElement( startEvent, events, start );</TD></TR><TR CLASS="c"><TD CLASS="l">938</TD><TD>                        String objClass = eventElt.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">939</TD><TD>                        if ( ( objClass != null ) &amp;&amp; ( objClass.length() &gt; 0 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">940</TD><TD>                                throw new InvalidMvp4gConfigurationException( String.format( NOT_EMPTY_EVENT_OBJ, start.getTagName(), &#34;start&#34;, eventElt.getType() ) );</TD></TR><TR><TD CLASS="l">941</TD><TD>                        }</TD></TR><TR><TD CLASS="l">942</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">943</TD><TD>        }</TD></TR><TR><TD CLASS="l">944</TD><TD> </TD></TR><TR><TD CLASS="l">945</TD><TD>        /**</TD></TR><TR><TD CLASS="l">946</TD><TD>         * For each event, deduce the object class associated with the event if needed thanks to</TD></TR><TR><TD CLASS="l">947</TD><TD>         * presenter definition.</TD></TR><TR><TD CLASS="l">948</TD><TD>         * </TD></TR><TR><TD CLASS="l">949</TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">950</TD><TD>         *             if handler doesn't define the method associated with the event if class of the</TD></TR><TR><TD CLASS="l"><A NAME="5">951</A></TD><TD>         *             handler can not be found</TD></TR><TR><TD CLASS="l">952</TD><TD>         */</TD></TR><TR><TD CLASS="l">953</TD><TD>        void findEventObjectClass() throws InvalidMvp4gConfigurationException {</TD></TR><TR><TD CLASS="l">954</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">955</TD><TD>                for ( EventElement event : events ) {</TD></TR><TR CLASS="c"><TD CLASS="l">956</TD><TD>                        String objectClass = event.getEventObjectClass();</TD></TR><TR CLASS="c"><TD CLASS="l">957</TD><TD>                        if ( objectClass == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">958</TD><TD>                                String[] handlers = event.getHandlers();</TD></TR><TR><TD CLASS="l">959</TD><TD> </TD></TR><TR><TD CLASS="l">960</TD><TD>                                // if no handler, then event object class can't be deduce</TD></TR><TR CLASS="c"><TD CLASS="l">961</TD><TD>                                if ( handlers.length != 0 ) {</TD></TR><TR CLASS="c"><TD CLASS="l">962</TD><TD>                                        String presenterClass = getElement( handlers[0], presenters, event ).getClassName();</TD></TR><TR><TD CLASS="l">963</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">964</TD><TD>                                        JClassType handlerClass = getType( event, presenterClass );</TD></TR><TR CLASS="c"><TD CLASS="l">965</TD><TD>                                        String eventMethod = event.getCalledMethod();</TD></TR><TR CLASS="c"><TD CLASS="l">966</TD><TD>                                        JParameter[] parameters = null;</TD></TR><TR CLASS="c"><TD CLASS="l">967</TD><TD>                                        boolean found = false;</TD></TR><TR CLASS="c"><TD CLASS="l">968</TD><TD>                                        int parameterSize = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">969</TD><TD>                                        for ( JMethod method : handlerClass.getMethods() ) {</TD></TR><TR CLASS="c"><TD CLASS="l">970</TD><TD>                                                if ( eventMethod.equals( method.getName() ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">971</TD><TD>                                                        parameters = method.getParameters();</TD></TR><TR CLASS="c"><TD CLASS="l">972</TD><TD>                                                        parameterSize = parameters.length;</TD></TR><TR CLASS="c"><TD CLASS="l">973</TD><TD>                                                        if ( parameterSize == 0 ) {</TD></TR><TR CLASS="c"><TD CLASS="l">974</TD><TD>                                                                found = true;</TD></TR><TR CLASS="c"><TD CLASS="l">975</TD><TD>                                                                break;</TD></TR><TR CLASS="c"><TD CLASS="l">976</TD><TD>                                                        } else if ( parameterSize == 1 ) {</TD></TR><TR CLASS="c"><TD CLASS="l">977</TD><TD>                                                                found = true;</TD></TR><TR><TD CLASS="l">978</TD><TD>                                                                try {</TD></TR><TR CLASS="c"><TD CLASS="l">979</TD><TD>                                                                        event.setEventObjectClass( parameters[0].getType().getQualifiedSourceName() );</TD></TR><TR CLASS="z"><TD CLASS="l">980</TD><TD>                                                                } catch ( DuplicatePropertyNameException e ) {</TD></TR><TR><TD CLASS="l">981</TD><TD>                                                                        // setter is only called once, so this error</TD></TR><TR><TD CLASS="l">982</TD><TD>                                                                        // can't occur.</TD></TR><TR><TD CLASS="l">983</TD><TD>                                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">984</TD><TD>                                                                break;</TD></TR><TR><TD CLASS="l">985</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">986</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">987</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">988</TD><TD>                                        if ( !found ) {</TD></TR><TR CLASS="c"><TD CLASS="l">989</TD><TD>                                                throw new InvalidMvp4gConfigurationException( &#34;Event &#34; + event.getType() + &#34;: handler &#34; + handlers[0]</TD></TR><TR CLASS="c"><TD CLASS="l">990</TD><TD>                                                                + &#34; doesn't define a method &#34; + event.getCalledMethod() + &#34; with 1 or 0 parameter.&#34; );</TD></TR><TR><TD CLASS="l">991</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">992</TD><TD> </TD></TR><TR><TD CLASS="l">993</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">994</TD><TD>                                        if ( event.hasForwardToParent() || event.getModulesToLoad().length &gt; 0 ) {</TD></TR><TR CLASS="c"><TD CLASS="l">995</TD><TD>                                                throw new InvalidMvp4gConfigurationException(</TD></TR><TR CLASS="c"><TD CLASS="l">996</TD><TD>                                                                &#34;Event &#34;</TD></TR><TR CLASS="c"><TD CLASS="l">997</TD><TD>                                                                                + event.getType()</TD></TR><TR CLASS="c"><TD CLASS="l">998</TD><TD>                                                                                + &#34;: you need to define the class of the object linked to this event since it is forwarded to the parent or child module. Since no presenter of this module handles it, it couldn't be deduce automaticaly. If no object is associated with this event, set eventObjectClass attribute to \&#34;\&#34;.&#34; );</TD></TR><TR><TD CLASS="l">999</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1000</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1001</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1002</TD><TD>                }</TD></TR><TR><TD CLASS="l">1003</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1004</TD><TD>        }</TD></TR><TR><TD CLASS="l">1005</TD><TD> </TD></TR><TR><TD CLASS="l">1006</TD><TD>        /*</TD></TR><TR><TD CLASS="l">1007</TD><TD>         * ANNOTATION LOAD</TD></TR><TR><TD CLASS="l">1008</TD><TD>         */</TD></TR><TR><TD CLASS="l">1009</TD><TD> </TD></TR><TR><TD CLASS="l">1010</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1011</TD><TD>         * Pre-loads information contained in Presenter annotations.</TD></TR><TR><TD CLASS="l">1012</TD><TD>         * </TD></TR><TR><TD CLASS="l">1013</TD><TD>         * @param annotedClasses</TD></TR><TR><TD CLASS="l">1014</TD><TD>         *            classes with the Presenter annotation</TD></TR><TR><TD CLASS="l"><A NAME="28">1015</A></TD><TD>         * @throws Mvp4gAnnotationException</TD></TR><TR><TD CLASS="l">1016</TD><TD>         *             thrown if presenter class associated with the annotation is not correct</TD></TR><TR><TD CLASS="l">1017</TD><TD>         */</TD></TR><TR><TD CLASS="l">1018</TD><TD>        void loadPresenters( List&lt;JClassType&gt; annotedClasses ) throws Mvp4gAnnotationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1019</TD><TD>                PresenterAnnotationsLoader loader = new PresenterAnnotationsLoader();</TD></TR><TR CLASS="c"><TD CLASS="l">1020</TD><TD>                loader.load( annotedClasses, this );</TD></TR><TR CLASS="c"><TD CLASS="l">1021</TD><TD>        }</TD></TR><TR><TD CLASS="l">1022</TD><TD> </TD></TR><TR><TD CLASS="l">1023</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1024</TD><TD>         * Pre-loads information contained in Service annotations.</TD></TR><TR><TD CLASS="l">1025</TD><TD>         * </TD></TR><TR><TD CLASS="l">1026</TD><TD>         * @param annotedClasses</TD></TR><TR><TD CLASS="l">1027</TD><TD>         *            classes with the Service annotation</TD></TR><TR><TD CLASS="l"><A NAME="2a">1028</A></TD><TD>         * @throws Mvp4gAnnotationException</TD></TR><TR><TD CLASS="l">1029</TD><TD>         *             thrown if service class associated with the annotation is not correct</TD></TR><TR><TD CLASS="l">1030</TD><TD>         */</TD></TR><TR><TD CLASS="l">1031</TD><TD>        void loadServices( List&lt;JClassType&gt; annotedClasses ) throws Mvp4gAnnotationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1032</TD><TD>                ServiceAnnotationsLoader loader = new ServiceAnnotationsLoader();</TD></TR><TR CLASS="c"><TD CLASS="l">1033</TD><TD>                loader.load( annotedClasses, this );</TD></TR><TR CLASS="c"><TD CLASS="l">1034</TD><TD>        }</TD></TR><TR><TD CLASS="l">1035</TD><TD> </TD></TR><TR><TD CLASS="l">1036</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1037</TD><TD>         * Pre-loads all Events contained in the class of the Events annotation. Build eventBus element</TD></TR><TR><TD CLASS="l">1038</TD><TD>         * if needed</TD></TR><TR><TD CLASS="l">1039</TD><TD>         * </TD></TR><TR><TD CLASS="l">1040</TD><TD>         * @param annotedClasses</TD></TR><TR><TD CLASS="l">1041</TD><TD>         *            classes with the Events annotation</TD></TR><TR><TD CLASS="l"><A NAME="22">1042</A></TD><TD>         * @throws Mvp4gAnnotationException</TD></TR><TR><TD CLASS="l">1043</TD><TD>         *             thrown if events class associated with the annotation is not correct</TD></TR><TR><TD CLASS="l">1044</TD><TD>         */</TD></TR><TR><TD CLASS="l">1045</TD><TD>        void loadEvents( List&lt;JClassType&gt; annotedClasses ) throws Mvp4gAnnotationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1046</TD><TD>                EventsAnnotationsLoader loader = new EventsAnnotationsLoader();</TD></TR><TR CLASS="c"><TD CLASS="l">1047</TD><TD>                loader.load( annotedClasses, this );</TD></TR><TR CLASS="c"><TD CLASS="l">1048</TD><TD>        }</TD></TR><TR><TD CLASS="l">1049</TD><TD> </TD></TR><TR><TD CLASS="l">1050</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1051</TD><TD>         * Pre-loads information contained in History annotations.</TD></TR><TR><TD CLASS="l">1052</TD><TD>         * </TD></TR><TR><TD CLASS="l">1053</TD><TD>         * @param annotedClasses</TD></TR><TR><TD CLASS="l">1054</TD><TD>         *            classes with the History annotation</TD></TR><TR><TD CLASS="l"><A NAME="25">1055</A></TD><TD>         * @throws Mvp4gAnnotationException</TD></TR><TR><TD CLASS="l">1056</TD><TD>         *             thrown if history converter class associated with the annotation is not correct</TD></TR><TR><TD CLASS="l">1057</TD><TD>         */</TD></TR><TR><TD CLASS="l">1058</TD><TD>        void loadHistoryConverters( List&lt;JClassType&gt; annotedClasses ) throws Mvp4gAnnotationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1059</TD><TD>                HistoryAnnotationsLoader loader = new HistoryAnnotationsLoader();</TD></TR><TR CLASS="c"><TD CLASS="l">1060</TD><TD>                loader.load( annotedClasses, this );</TD></TR><TR CLASS="c"><TD CLASS="l">1061</TD><TD>        }</TD></TR><TR><TD CLASS="l">1062</TD><TD> </TD></TR><TR><TD CLASS="l">1063</TD><TD>        /*</TD></TR><TR><TD CLASS="l">1064</TD><TD>         * LOAD XML CONFIGURATION</TD></TR><TR><TD CLASS="l">1065</TD><TD>         */</TD></TR><TR><TD CLASS="l">1066</TD><TD> </TD></TR><TR><TD CLASS="l">1067</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1068</TD><TD>         * Pre-loads all Presenters in the configuration file.</TD></TR><TR><TD CLASS="l">1069</TD><TD>         * </TD></TR><TR><TD CLASS="l">1070</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1071</TD><TD>         *            raw representation of the configuration file.</TD></TR><TR><TD CLASS="l">1072</TD><TD>         * </TD></TR><TR><TD CLASS="l">1073</TD><TD>         * @throws Mvp4gXmlException</TD></TR><TR><TD CLASS="l"><A NAME="29">1074</A></TD><TD>         *             if presenter tags cannot be loaded.</TD></TR><TR><TD CLASS="l">1075</TD><TD>         * </TD></TR><TR><TD CLASS="l">1076</TD><TD>         */</TD></TR><TR><TD CLASS="l">1077</TD><TD>        void loadPresenters( XMLConfiguration xmlConfig ) throws Mvp4gXmlException {</TD></TR><TR CLASS="c"><TD CLASS="l">1078</TD><TD>                PresentersLoader presentersConfig = new PresentersLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">1079</TD><TD>                presenters = presentersConfig.loadElements();</TD></TR><TR CLASS="c"><TD CLASS="l">1080</TD><TD>        }</TD></TR><TR><TD CLASS="l">1081</TD><TD> </TD></TR><TR><TD CLASS="l">1082</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1083</TD><TD>         * Pre-loads all Services in the configuration file.</TD></TR><TR><TD CLASS="l">1084</TD><TD>         * </TD></TR><TR><TD CLASS="l">1085</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1086</TD><TD>         *            raw representation of the configuration file.</TD></TR><TR><TD CLASS="l">1087</TD><TD>         * </TD></TR><TR><TD CLASS="l">1088</TD><TD>         * @throws Mvp4gXmlException</TD></TR><TR><TD CLASS="l"><A NAME="2b">1089</A></TD><TD>         *             if service tags cannot be loaded.</TD></TR><TR><TD CLASS="l">1090</TD><TD>         * </TD></TR><TR><TD CLASS="l">1091</TD><TD>         */</TD></TR><TR><TD CLASS="l">1092</TD><TD>        void loadServices( XMLConfiguration xmlConfig ) throws Mvp4gXmlException {</TD></TR><TR CLASS="c"><TD CLASS="l">1093</TD><TD>                ServicesLoader servicesConfig = new ServicesLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">1094</TD><TD>                services = servicesConfig.loadElements();</TD></TR><TR CLASS="c"><TD CLASS="l">1095</TD><TD>        }</TD></TR><TR><TD CLASS="l">1096</TD><TD> </TD></TR><TR><TD CLASS="l">1097</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1098</TD><TD>         * Pre-loads all Views in the configuration file.</TD></TR><TR><TD CLASS="l">1099</TD><TD>         * </TD></TR><TR><TD CLASS="l">1100</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1101</TD><TD>         *            raw representation of the configuration file.</TD></TR><TR><TD CLASS="l">1102</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="2d">1103</A></TD><TD>         * @throws Mvp4gXmlException</TD></TR><TR><TD CLASS="l">1104</TD><TD>         *             if view tags cannot be loaded.</TD></TR><TR><TD CLASS="l">1105</TD><TD>         */</TD></TR><TR><TD CLASS="l">1106</TD><TD>        void loadViews( XMLConfiguration xmlConfig ) throws Mvp4gXmlException {</TD></TR><TR CLASS="c"><TD CLASS="l">1107</TD><TD>                ViewsLoader viewsConfig = new ViewsLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">1108</TD><TD>                views = viewsConfig.loadElements();</TD></TR><TR CLASS="c"><TD CLASS="l">1109</TD><TD>        }</TD></TR><TR><TD CLASS="l">1110</TD><TD> </TD></TR><TR><TD CLASS="l">1111</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1112</TD><TD>         * Pre-loads all Events in the configuration file.</TD></TR><TR><TD CLASS="l">1113</TD><TD>         * </TD></TR><TR><TD CLASS="l">1114</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1115</TD><TD>         *            raw representation of the configuration file.</TD></TR><TR><TD CLASS="l">1116</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="23">1117</A></TD><TD>         * @throws Mvp4gXmlException</TD></TR><TR><TD CLASS="l">1118</TD><TD>         *             if event tags cannot be loaded.</TD></TR><TR><TD CLASS="l">1119</TD><TD>         */</TD></TR><TR><TD CLASS="l">1120</TD><TD>        void loadEvents( XMLConfiguration xmlConfig ) throws Mvp4gXmlException {</TD></TR><TR CLASS="c"><TD CLASS="l">1121</TD><TD>                EventsLoader eventsConfig = new EventsLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">1122</TD><TD>                events = eventsConfig.loadElements();</TD></TR><TR CLASS="c"><TD CLASS="l">1123</TD><TD>                if ( events.size() &gt; 0 ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1124</TD><TD>                        eventBus = new EventBusElement( EventBusWithLookup.class.getCanonicalName(), BaseEventBusWithLookUp.class.getCanonicalName(), true );</TD></TR><TR><TD CLASS="l">1125</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1126</TD><TD>        }</TD></TR><TR><TD CLASS="l">1127</TD><TD> </TD></TR><TR><TD CLASS="l">1128</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1129</TD><TD>         * Pre-loads all History Converter in the configuration file.</TD></TR><TR><TD CLASS="l">1130</TD><TD>         * </TD></TR><TR><TD CLASS="l">1131</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1132</TD><TD>         *            raw representation of the configuration file.</TD></TR><TR><TD CLASS="l">1133</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="26">1134</A></TD><TD>         * @throws Mvp4gXmlException</TD></TR><TR><TD CLASS="l">1135</TD><TD>         *             if event tags cannot be loaded.</TD></TR><TR><TD CLASS="l">1136</TD><TD>         */</TD></TR><TR><TD CLASS="l">1137</TD><TD>        void loadHistoryConverters( XMLConfiguration xmlConfig ) throws Mvp4gXmlException {</TD></TR><TR CLASS="c"><TD CLASS="l">1138</TD><TD>                HistoryConverterLoader historyConverterConfig = new HistoryConverterLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">1139</TD><TD>                historyConverters = historyConverterConfig.loadElements();</TD></TR><TR CLASS="c"><TD CLASS="l">1140</TD><TD>        }</TD></TR><TR><TD CLASS="l">1141</TD><TD> </TD></TR><TR><TD CLASS="l">1142</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1143</TD><TD>         * Pre-loads the Start element in the configuration file.</TD></TR><TR><TD CLASS="l">1144</TD><TD>         * </TD></TR><TR><TD CLASS="l">1145</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1146</TD><TD>         *            raw representation of mvp4g-config.xml file.</TD></TR><TR><TD CLASS="l">1147</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="2c">1148</A></TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">1149</TD><TD>         *             if start tag cannot be loaded.</TD></TR><TR><TD CLASS="l">1150</TD><TD>         */</TD></TR><TR><TD CLASS="l">1151</TD><TD>        void loadStart( XMLConfiguration xmlConfig ) throws InvalidMvp4gConfigurationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1152</TD><TD>                StartLoader startConfig = new StartLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="1f">1153</A></TD><TD>                start = startConfig.loadElement();</TD></TR><TR CLASS="c"><TD CLASS="l">1154</TD><TD>        }</TD></TR><TR><TD CLASS="l">1155</TD><TD> </TD></TR><TR><TD CLASS="l">1156</TD><TD>        void loadChildConfig( XMLConfiguration xmlConfig ) throws InvalidMvp4gConfigurationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1157</TD><TD>                ChildModulesLoader childConfigLoader = new ChildModulesLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="20">1158</A></TD><TD>                loadChildConfig = childConfigLoader.loadElement();</TD></TR><TR CLASS="c"><TD CLASS="l">1159</TD><TD>        }</TD></TR><TR><TD CLASS="l">1160</TD><TD> </TD></TR><TR><TD CLASS="l">1161</TD><TD>        void loadChildModules( XMLConfiguration xmlConfig ) throws Mvp4gXmlException, NotFoundClassException {</TD></TR><TR CLASS="c"><TD CLASS="l">1162</TD><TD>                ChildModuleLoader loader = new ChildModuleLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="21">1163</A></TD><TD>                childModules = loader.loadElements();</TD></TR><TR CLASS="c"><TD CLASS="l">1164</TD><TD>        }</TD></TR><TR><TD CLASS="l">1165</TD><TD> </TD></TR><TR><TD CLASS="l">1166</TD><TD>        void loadDebug( XMLConfiguration xmlConfig ) throws Mvp4gXmlException, NotFoundClassException {</TD></TR><TR CLASS="c"><TD CLASS="l">1167</TD><TD>                DebugLoader loader = new DebugLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l">1168</TD><TD>                debug = loader.loadElement();</TD></TR><TR CLASS="c"><TD CLASS="l">1169</TD><TD>        }</TD></TR><TR><TD CLASS="l">1170</TD><TD> </TD></TR><TR><TD CLASS="l">1171</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1172</TD><TD>         * Pre-loads the History element in the configuration file.</TD></TR><TR><TD CLASS="l">1173</TD><TD>         * </TD></TR><TR><TD CLASS="l">1174</TD><TD>         * @param xmlConfig</TD></TR><TR><TD CLASS="l">1175</TD><TD>         *            raw representation of mvp4g-config.xml file.</TD></TR><TR><TD CLASS="l">1176</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="24">1177</A></TD><TD>         * @throws InvalidMvp4gConfigurationException</TD></TR><TR><TD CLASS="l">1178</TD><TD>         *             if start tag cannot be loaded.</TD></TR><TR><TD CLASS="l">1179</TD><TD>         */</TD></TR><TR><TD CLASS="l">1180</TD><TD>        void loadHistory( XMLConfiguration xmlConfig ) throws InvalidMvp4gConfigurationException {</TD></TR><TR CLASS="c"><TD CLASS="l">1181</TD><TD>                HistoryLoader historyConfig = new HistoryLoader( xmlConfig );</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="27">1182</A></TD><TD>                history = historyConfig.loadElement();</TD></TR><TR CLASS="c"><TD CLASS="l">1183</TD><TD>        }</TD></TR><TR><TD CLASS="l">1184</TD><TD> </TD></TR><TR><TD CLASS="l">1185</TD><TD>        void loadParentModule() throws NotFoundClassException {</TD></TR><TR CLASS="c"><TD CLASS="l">1186</TD><TD>                parentModule = findParentModule( module.getQualifiedSourceName() );</TD></TR><TR CLASS="c"><TD CLASS="l">1187</TD><TD>                if ( parentModule != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1188</TD><TD>                        parentEventBus = othersEventBusClassMap.get( parentModule.getQualifiedSourceName() );</TD></TR><TR CLASS="c"><TD CLASS="l">1189</TD><TD>                        if ( parentEventBus == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1190</TD><TD>                                parentEventBus = getType( null, EventBusWithLookup.class.getCanonicalName() );</TD></TR><TR CLASS="c"><TD CLASS="l">1191</TD><TD>                                logger.log( TreeLogger.WARN, PARENT_EVENT_BUS_WARNING );</TD></TR><TR><TD CLASS="l">1192</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1193</TD><TD>                        HistoryName hName = module.getAnnotation( HistoryName.class );</TD></TR><TR CLASS="c"><TD CLASS="l">1194</TD><TD>                        if ( hName != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1195</TD><TD>                                historyName = hName.value();</TD></TR><TR><TD CLASS="l">1196</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1197</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1198</TD><TD>        }</TD></TR><TR><TD CLASS="l">1199</TD><TD> </TD></TR><TR><TD CLASS="l">1200</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1201</TD><TD>         * Verify that id of elements contained in the set isn't already contained in the ids set.</TD></TR><TR><TD CLASS="l">1202</TD><TD>         * </TD></TR><TR><TD CLASS="l">1203</TD><TD>         * @param &lt;E&gt;</TD></TR><TR><TD CLASS="l">1204</TD><TD>         *            type of elements contained in the set</TD></TR><TR><TD CLASS="l">1205</TD><TD>         * @param subset</TD></TR><TR><TD CLASS="l">1206</TD><TD>         *            set of elements to test</TD></TR><TR><TD CLASS="l">1207</TD><TD>         * @param ids</TD></TR><TR><TD CLASS="l">1208</TD><TD>         *            set containing the ids</TD></TR><TR><TD CLASS="l">1209</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="7">1210</A></TD><TD>         * @throws NonUniqueIdentifierException</TD></TR><TR><TD CLASS="l">1211</TD><TD>         *             if id of an element is already contained in the ids set.</TD></TR><TR><TD CLASS="l">1212</TD><TD>         */</TD></TR><TR><TD CLASS="l">1213</TD><TD>        private &lt;E extends Mvp4gElement&gt; void checkUniquenessOf( Set&lt;E&gt; subset, Set&lt;String&gt; ids ) throws NonUniqueIdentifierException {</TD></TR><TR CLASS="c"><TD CLASS="l">1214</TD><TD>                for ( E item : subset ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1215</TD><TD>                        boolean unique = ids.add( item.getUniqueIdentifier() );</TD></TR><TR CLASS="c"><TD CLASS="l">1216</TD><TD>                        if ( !unique ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1217</TD><TD>                                throw new NonUniqueIdentifierException( item.getUniqueIdentifier() );</TD></TR><TR><TD CLASS="l">1218</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1219</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1220</TD><TD>        }</TD></TR><TR><TD CLASS="l">1221</TD><TD> </TD></TR><TR><TD CLASS="l">1222</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1223</TD><TD>         * Retrieve an element exists in a set thanks to its unique identifier</TD></TR><TR><TD CLASS="l">1224</TD><TD>         * </TD></TR><TR><TD CLASS="l">1225</TD><TD>         * @param &lt;T&gt;</TD></TR><TR><TD CLASS="l">1226</TD><TD>         *            type of the elements in the set</TD></TR><TR><TD CLASS="l">1227</TD><TD>         * @param elementName</TD></TR><TR><TD CLASS="l">1228</TD><TD>         *            value of the unique identifier of the element to find</TD></TR><TR><TD CLASS="l">1229</TD><TD>         * @param elements</TD></TR><TR><TD CLASS="l">1230</TD><TD>         *            set of elemets</TD></TR><TR><TD CLASS="l">1231</TD><TD>         * @return element if found, null otherwise</TD></TR><TR><TD CLASS="l"><A NAME="b">1232</A></TD><TD>         * @throws UnknownConfigurationElementException</TD></TR><TR><TD CLASS="l">1233</TD><TD>         */</TD></TR><TR><TD CLASS="l">1234</TD><TD>        private &lt;T extends Mvp4gElement&gt; T getElement( String elementName, Set&lt;T&gt; elements, Mvp4gElement relatedElement )</TD></TR><TR><TD CLASS="l">1235</TD><TD>                        throws UnknownConfigurationElementException {</TD></TR><TR CLASS="c"><TD CLASS="l">1236</TD><TD>                T eFound = null;</TD></TR><TR CLASS="c"><TD CLASS="l">1237</TD><TD>                for ( T element : elements ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1238</TD><TD>                        if ( element.getUniqueIdentifier().equals( elementName ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1239</TD><TD>                                eFound = element;</TD></TR><TR CLASS="c"><TD CLASS="l">1240</TD><TD>                                break;</TD></TR><TR><TD CLASS="l">1241</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1242</TD><TD>                }</TD></TR><TR><TD CLASS="l">1243</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1244</TD><TD>                if ( eFound == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1245</TD><TD>                        throw new UnknownConfigurationElementException( relatedElement, elementName );</TD></TR><TR><TD CLASS="l">1246</TD><TD>                }</TD></TR><TR><TD CLASS="l">1247</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1248</TD><TD>                return eFound;</TD></TR><TR><TD CLASS="l">1249</TD><TD>        }</TD></TR><TR><TD CLASS="l">1250</TD><TD> </TD></TR><TR><TD CLASS="l">1251</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1252</TD><TD>         * Remove all elements of the useless set from the set</TD></TR><TR><TD CLASS="l">1253</TD><TD>         * </TD></TR><TR><TD CLASS="l">1254</TD><TD>         * @param &lt;T&gt;</TD></TR><TR><TD CLASS="l">1255</TD><TD>         *            type of the elements to remove</TD></TR><TR><TD CLASS="l">1256</TD><TD>         * @param set</TD></TR><TR><TD CLASS="l">1257</TD><TD>         *            set where elements need to be removed</TD></TR><TR><TD CLASS="l"><A NAME="2e">1258</A></TD><TD>         * @param toRemove</TD></TR><TR><TD CLASS="l">1259</TD><TD>         *            set of elements to remove</TD></TR><TR><TD CLASS="l">1260</TD><TD>         */</TD></TR><TR><TD CLASS="l">1261</TD><TD>        private &lt;T extends Mvp4gElement&gt; void removeUselessElements( Set&lt;T&gt; set, Set&lt;T&gt; toRemove ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1262</TD><TD>                for ( T e : toRemove ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1263</TD><TD>                        set.remove( e );</TD></TR><TR CLASS="c"><TD CLASS="l">1264</TD><TD>                        logger.log( TreeLogger.DEBUG, String.format( REMOVE_OBJ, e.getTagName(), e.getUniqueIdentifier() ) );</TD></TR><TR><TD CLASS="l">1265</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1266</TD><TD>        }</TD></TR><TR><TD CLASS="l">1267</TD><TD> </TD></TR><TR><TD CLASS="l">1268</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1269</TD><TD>         * Retrieve a type from the oracle.</TD></TR><TR><TD CLASS="l">1270</TD><TD>         * </TD></TR><TR><TD CLASS="l">1271</TD><TD>         * @param element</TD></TR><TR><TD CLASS="l">1272</TD><TD>         *            element that asks to retrieve the class (can be null)</TD></TR><TR><TD CLASS="l">1273</TD><TD>         * @param className</TD></TR><TR><TD CLASS="l">1274</TD><TD>         *            name of the class to retrieve</TD></TR><TR><TD CLASS="l">1275</TD><TD>         * @return type of the class</TD></TR><TR><TD CLASS="l">1276</TD><TD>         * </TD></TR><TR><TD CLASS="l"><A NAME="1a">1277</A></TD><TD>         * @throws NotFoundClassException</TD></TR><TR><TD CLASS="l">1278</TD><TD>         *             if the class can not be found</TD></TR><TR><TD CLASS="l">1279</TD><TD>         */</TD></TR><TR><TD CLASS="l">1280</TD><TD>        private JClassType getType( Mvp4gElement element, String className ) throws NotFoundClassException {</TD></TR><TR CLASS="c"><TD CLASS="l">1281</TD><TD>                JClassType type = oracle.findType( className );</TD></TR><TR CLASS="c"><TD CLASS="l">1282</TD><TD>                if ( type == null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1283</TD><TD>                        throw new NotFoundClassException( element, className );</TD></TR><TR><TD CLASS="l">1284</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="3">1285</A></TD><TD>                return type;</TD></TR><TR><TD CLASS="l">1286</TD><TD>        }</TD></TR><TR><TD CLASS="l">1287</TD><TD> </TD></TR><TR><TD CLASS="l">1288</TD><TD>        private JClassType findParentModule( String moduleClassName ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1289</TD><TD>                JClassType parentModule = null;</TD></TR><TR><TD CLASS="l">1290</TD><TD>                JClassType module;</TD></TR><TR><TD CLASS="l">1291</TD><TD>                try {</TD></TR><TR CLASS="c"><TD CLASS="l">1292</TD><TD>                        module = getType( null, moduleClassName );</TD></TR><TR CLASS="c"><TD CLASS="l">1293</TD><TD>                        JMethod[] methods = module.getMethods();</TD></TR><TR CLASS="p"><TD CLASS="l" TITLE="97% line coverage (31 out of 32 instructions)">1294</TD><TD TITLE="97% line coverage (31 out of 32 instructions)">                        for ( JMethod m : methods ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1295</TD><TD>                                if ( &#34;setParentModule&#34;.equals( m.getName() ) &amp;&amp; ( m.getParameters().length == 1 ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1296</TD><TD>                                        parentModule = m.getParameters()[0].getType().isClassOrInterface();</TD></TR><TR CLASS="c"><TD CLASS="l">1297</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">1298</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1299</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1300</TD><TD>                } catch ( NotFoundClassException e ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1301</TD><TD>                        parentModule = null;</TD></TR><TR><TD CLASS="l">1302</TD><TD>                }</TD></TR><TR><TD CLASS="l">1303</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1304</TD><TD>                return parentModule;</TD></TR><TR><TD CLASS="l">1305</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="4">1306</A></TD><TD> </TD></TR><TR><TD CLASS="l">1307</TD><TD>        void findChildModuleHistoryName() throws InvalidMvp4gConfigurationException {</TD></TR><TR><TD CLASS="l">1308</TD><TD>                JClassType childType;</TD></TR><TR><TD CLASS="l">1309</TD><TD>                HistoryName hName;</TD></TR><TR CLASS="c"><TD CLASS="l">1310</TD><TD>                List&lt;String&gt; historyNames = new ArrayList&lt;String&gt;();</TD></TR><TR CLASS="c"><TD CLASS="l">1311</TD><TD>                for ( ChildModuleElement childModule : childModules ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1312</TD><TD>                        childType = getType( childModule, childModule.getClassName() );</TD></TR><TR CLASS="c"><TD CLASS="l">1313</TD><TD>                        hName = childType.getAnnotation( HistoryName.class );</TD></TR><TR CLASS="c"><TD CLASS="l">1314</TD><TD>                        if ( hName != null ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1315</TD><TD>                                String hNameStr = hName.value();</TD></TR><TR CLASS="c"><TD CLASS="l">1316</TD><TD>                                if ( historyNames.contains( hNameStr ) ) {</TD></TR><TR CLASS="c"><TD CLASS="l">1317</TD><TD>                                        throw new InvalidMvp4gConfigurationException( String.format( CHILD_MODULE_SAME_HISTORY_NAME, module.getQualifiedSourceName(),</TD></TR><TR CLASS="c"><TD CLASS="l">1318</TD><TD>                                                        hNameStr ) );</TD></TR><TR><TD CLASS="l">1319</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">1320</TD><TD>                                        historyNames.add( hNameStr );</TD></TR><TR><TD CLASS="l">1321</TD><TD>                                        try {</TD></TR><TR CLASS="c"><TD CLASS="l">1322</TD><TD>                                                childModule.setHistoryName( hNameStr );</TD></TR><TR CLASS="z"><TD CLASS="l">1323</TD><TD>                                        } catch ( DuplicatePropertyNameException e ) {</TD></TR><TR><TD CLASS="l">1324</TD><TD>                                                // exception can't occur, only time you set this value</TD></TR><TR><TD CLASS="l">1325</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1326</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1327</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1328</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1329</TD><TD>        }</TD></TR><TR><TD CLASS="l">1330</TD><TD> </TD></TR><TR><TD CLASS="l">1331</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../10_03_16_coverage.html">all classes</A>][<A HREF="5.html">com.mvp4g.util.config</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://www.eclemma.org/support.html">EMMA 2.0.5312 EclEmma Fix 1</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>